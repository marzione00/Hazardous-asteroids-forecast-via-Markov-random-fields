install.packages("corrplot")
corrplot(Asteroids[,2:13] , type = "upper", order = "hclust",
tl.col = "black", tl.srt = 45)
library(corrplot)
corrplot(Asteroids[,2:13] , type = "upper", order = "hclust", tl.col = "black", tl.srt = 45)
corrplot(Asteroids[,2:13])
chart.Correlation(Asteroids[,2:13] , histogram=TRUE, pch=19)
chart.Correlation(Asteroids[,2:13] , histogram=TRUE, pch=19)
heatmap(Asteroids[,2:13])
heatmap(x=Asteroids[,2:13])
library(ggcorrplot)
heatmap(x=M_cor)
M_cor <- cor(Asteroids[,2:14])
heatmap(x=M_cor)
ggcorrplot(M_cor)
library(ggcorrplot)
install.packages("ggcorrplot")
ggcorrplot(M_cor)
library(ggcorrplot)
ggcorrplot(M_cor)
library(readxl)
library(gRim)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(bnlearn)
Asteroids <- read_excel("Dataset/Asteroids_REF2.xlsx")
Asteroids[sapply(Asteroids, is.character)]  <- lapply(Asteroids[sapply(Asteroids, is.character)], as.factor)
Asteroids[2:7] <- lapply(Asteroids[2:7], as.numeric)
msx<-dmod(~.^.,data=Asteroids[1:10,2:8])
msx2<-stepwise(msx,crit="test", alpha=0.05,details = 2)
plot(msx2)
msx<-dmod(~.^.,data=Asteroids[10:20,2:8])
msx2<-stepwise(msx,crit="test", alpha=0.05,details = 2)
plot(msx2)
View(Asteroids)
Asteroids <- read_excel("Dataset/Asteroids_REF2.xlsx")
Asteroids[sapply(Asteroids, is.character)]  <- lapply(Asteroids[sapply(Asteroids, is.character)], as.factor)
View(Asteroids)
View(Asteroids)
Asteroids <- read_excel("Dataset/Asteroids_REF2.xlsx")
Asteroids[sapply(Asteroids, is.character)]  <- lapply(Asteroids[sapply(Asteroids, is.character)], as.factor)
View(Asteroids)
msx<-mmod(~.^.,data=Asteroids[10:20,2:8])
msx<-mmod(~.^.,data=Asteroids[10:20,2:8])
msx<-mmod(~.^.,data=Asteroids[10:20,2:8])
View(Asteroids)
Asteroids[2:7] <- lapply(Asteroids[2:7], as.numeric)
msx<-mmod(~.^.,data=Asteroids[10:20,2:8])
msx<-mmod(~.^.,data=Asteroids[10:20,2:8])
install.packages("GRapHD")
BiocManager::install("GRapHD")
install.packages("https://cran.r-project.org/src/contrib/Archive/gRapHD/gRapHD_0.2.5.tar.gz", repos = NULL, type = "source")
library(gRapHD)
bF <- minForest(Asteroids[2:7])
Asteroids <- read_excel("Dataset/Asteroids_REF2.xlsx")
Asteroids[sapply(Asteroids, is.character)]  <- lapply(Asteroids[sapply(Asteroids, is.character)], as.factor)
Asteroids[2:7] <- lapply(Asteroids[2:7], as.numeric)
View(Asteroids)
bF <- minForest(Asteroids[2:7])
bF <- minForest(Asteroids[3:7])
data("breastcancer")
dim(breastcancer)
table(sapply(Asteroids[3:7],class))
table(sapply(breastcancer,class))
View(breastcancer)
bF <- minForest(Asteroids)
View(breastcancer)
Asteroids <- read_excel("Dataset/Asteroids_REF2.xlsx")
Asteroids[sapply(Asteroids, is.character)]  <- lapply(Asteroids[sapply(Asteroids, is.character)], as.factor)
Asteroids[2:7] <- lapply(Asteroids[2:7], as.numeric)
bF <- minForest(Asteroids)
Asteroids[sapply(Asteroids, is.character)]  <- lapply(Asteroids[sapply(Asteroids, is.character)], as.factor)
Asteroids[2:7] <- lapply(Asteroids[2:7], as.numeric)
Asteroids <- read_excel("Dataset/Asteroids_REF2.xlsx")
Asteroids[sapply(Asteroids, is.character)]  <- lapply(Asteroids[sapply(Asteroids, is.character)], as.factor)
Asteroids[2:7] <- lapply(Asteroids[2:7], as.numeric)
View(Asteroids)
SS <- CGstats(Asteroids,varnames =c("Min_DIA","Speed","Eccentricity","Inclination","Orbital_Period","Mean_motion","Hazardous"))
SS
apply(SS$center,1,sd) /apply(SS$center,1,mean)
SS
cc<-apply(SS$center,1,sd) /apply(SS$center,1,mean)
cc
msx<-mmod(~.^.,data=Asteroids[10:20,2:8])
msx<-mmod(~.^.,data=Asteroids[10:20,5:8])
msx<-mmod(~.^.,data=Asteroids[10:20,7:8])
msx<-mmod(~.^.,data=Asteroids[10:20,6:8])
Asteroids <- read_excel("Dataset/Asteroids_REF2.xlsx")
Asteroids[sapply(Asteroids, is.character)]  <- lapply(Asteroids[sapply(Asteroids, is.character)], as.factor)
Asteroids[2:6] <- lapply(Asteroids[2:6], as.numeric)
SS <- CGstats(Asteroids,varnames =c("Min_DIA","Speed","Eccentricity","Inclination","Orbital_Period","Hazardous"))
msx<-mmod(~.^.,data=Asteroids[10:20,5:7])
msx<-mmod(~.^.,data=Asteroids[10:20,6:7])
View(Asteroids)
msx<-mmod(~.^.,data=Asteroids[10:20,4:6])
Asteroids <- read_excel("Dataset/Asteroids_REF2.xlsx")
Asteroids[2:6] <- lapply(Asteroids[2:6], as.numeric)
msx<-mmod(~.^.,data=Asteroids[10:20,2:7])
msx<-dmod(~.^.,data=Asteroids[10:20,2:7])
msx2<-stepwise(msx,crit="test", alpha=0.05,details = 2)
plot(msx2)
msx2<-stepwise(msx,crit="test", alpha=0.15,details = 2)
plot(msx2)
msx<-dmod(~.^.,data=Asteroids[10:20,2:7])
msx2<-stepwise(msx,crit="test", alpha=0.15,details = 2)
plot(msx2)
View(Asteroids)
msx<-dmod(~.^.,data=Asteroids[1:20,2:7])
msx2<-stepwise(msx,crit="test", alpha=0.15,details = 2)
plot(msx2)
msx<-dmod(~.^.,data=Asteroids[1:30,2:7])
msx2<-stepwise(msx,crit="test", alpha=0.15,details = 2)
plot(msx2)
type = c(rep("g",6),"c")
type
levels = c(3,rep(1,13))
levels
levels = c(rep(1,13),2)
levels
fit_mgm <- mgm(data = Asteroids[1:30,2:7],
type = c(rep("g",6),"c"),
levels = c(rep(1,6),2),
k=2, # we consider only the second order interactions
lambdaSel = "CV", # use the cross- validation to select the parameter lambda of the l1 penalty. Other option is EBIC: Extended BIC
1
lambdaFolds= 10,
ruleReg="AND", # if, in an edge, there is at least one parameter equal to 0, the weight is set equal to zero.
overparameterize = T)# for 1 parameter to any levels of the cat variables
fit_mgm <- mgm(data = Asteroids[1:300,2:7],type = c(rep("g",6),"c"),levels = c(rep(1,6),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
fit_mgm <- mgm(data = Asteroids[1:300,2:7],type = c(rep("g",6),"c"),levels = c(rep(1,6),2))
Asteroids[1:300,2:7]
c(rep("g",6),"c")
fit_mgm <- mgm(data = Asteroids[1:300,2:7],type = c(rep("g",5),"c"),levels = c(rep(1,5),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
plot(fit_mgm)
View(fit_mgm)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(wine),
color = c("purple",rep("lightblue",13)),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids[1:300,2:7]),
color = c("purple",rep("lightblue",13)),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
fit_mgm <- mgm(data = Asteroids[1:3000,2:7],type = c(rep("g",5),"c"),levels = c(rep(1,5),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids[1:300,2:7]),
color = c("purple",rep("lightblue",13)),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
Asteroids <- read_excel("Dataset/Asteroids_REF.xlsx")
View(Asteroids)
Asteroids[sapply(Asteroids, is.character)]  <- lapply(Asteroids[sapply(Asteroids, is.character)], as.factor)
Asteroids[2:13] <- lapply(Asteroids[2:13], as.numeric)
View(Asteroids)
fit_mgm <- mgm(data = Asteroids[1:3000,2:7],type = c(rep("g",13),"c"),levels = c(rep(1,13),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
fit_mgm <- mgm(data = Asteroids[1:3000,2:14],type = c(rep("g",13),"c"),levels = c(rep(1,13),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
Asteroids[2:13] <- lapply(Asteroids[2:13], as.numeric)
fit_mgm <- mgm(data = Asteroids[1:3000,2:14],type = c(rep("g",13),"c"),levels = c(rep(1,13),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
Asteroids[1:3000,2:14]
rep("g",13),"c"
c(rep("g",13),"c")
fit_mgm <- mgm(data = Asteroids[1:3000,2:14],type = c(rep("g",12),"c"),levels = c(rep(1,12),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
fit_mgm <- mgm(data = Asteroids[1:3000,10:14],type = c(rep("g",3),"c"),levels = c(rep(1,3),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
Asteroids[1:3000,10:14]
fit_mgm <- mgm(data = Asteroids[1:3000,10:14],type = c(rep("g",4),"c"),levels = c(rep(1,4),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
Asteroids <- read_excel("Dataset/Asteroids_REF.xlsx")
Asteroids[sapply(Asteroids, is.character)]  <- lapply(Asteroids[sapply(Asteroids, is.character)], as.factor)
Asteroids[2:13] <- lapply(Asteroids[2:13], as.numeric)
View(Asteroids)
fit_mgm <- mgm(data = Asteroids[1:3000,10:14],type = c(rep("g",4),"c"),levels = c(rep(1,4),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
fit_mgm <- mgm(data = Asteroids[1:3000,10:14],type = c(rep("g",6),"c"),levels = c(rep(1,4),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
dim(Asteroids[1:3000,2:14)
dim(Asteroids[1:3000,2:14])
fit_mgm <- mgm(data = Asteroids[1:3000,2:14],type = c(rep("g",12),"c"),levels = c(rep(1,12),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
c(rep("g",12),"c")
c(rep(1,12),2)
fit_mgm <- mgm(data = Asteroids[1:3000,2:14],type = c(rep("g",12),"c"),levels = c(rep(1,12),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
Asteroids <- read_excel("Dataset/Asteroids_REF.xlsx")
Asteroids[sapply(Asteroids, is.character)]  <- lapply(Asteroids[sapply(Asteroids, is.character)], as.factor)
Asteroids[2:13] <- lapply(Asteroids[2:13], as.numeric)
fit_mgm <- mgm(data = Asteroids[1:3000,2:14],type = c(rep("g",12),"c"),levels = c(rep(1,12),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids[1:300,2:7]),
color = c("purple",rep("lightblue",13)),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids[1:3000,2:14]),
color = c("purple",rep("lightblue",13)),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids[1:3000,2:14]),
color = c("purple",rep("lightblue",13)),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
fit_mgm <- mgm(data = Asteroids[,2:14],type = c(rep("g",12),"c"),levels = c(rep(1,12),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids[1:3000,2:14]),
color = c("purple",rep("lightblue",13)),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
fit_mgm <- mgm(data = Asteroids[,2:14],type = c(rep("g",12),"c"),levels = c(rep(1,12),2),k=3,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids[1:3000,2:14]),
color = c("purple",rep("lightblue",13)),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
fit_mgm <- mgm(data = Asteroids[,2:14],type = c(rep("g",12),"c"),levels = c(rep(1,12),2),k=1,lambdaSel = "CV",lambdaFolds= 5,ruleReg="AND",overparameterize = T)
fit_mgm <- mgm(data = Asteroids[,2:14],type = c(rep("g",12),"c"),levels = c(rep(1,12),2),k=2,lambdaSel = "CV",lambdaFolds= 5,ruleReg="AND",overparameterize = T)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids[1:3000,2:14]),
color = c("purple",rep("lightblue",13)),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
fit_mgm <- mgm(data = Asteroids[,2:14],type = c(rep("g",12),"c"),levels = c(rep(1,12),2),k=2,lambdaSel = "CV",lambdaFolds= 3,ruleReg="AND",overparameterize = T)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids[1:3000,2:14]),
color = c("purple",rep("lightblue",13)),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
Asteroids <- read_excel("Dataset/Asteroids_REF.xlsx")
Asteroids[sapply(Asteroids, is.character)]  <- lapply(Asteroids[sapply(Asteroids, is.character)], as.factor)
Asteroids[sapply(Asteroids, is.character)]  <- lapply(Asteroids[sapply(Asteroids, is.character)], as.factor)
Asteroids[2:13] <- lapply(Asteroids[2:8], as.numeric)
fit_mgm <- mgm(data = Asteroids[,2:8],type = c(rep("g",7),"c"),levels = c(rep(1,7),2),k=2,lambdaSel = "CV",lambdaFolds= 3,ruleReg="AND",overparameterize = T)
View(Asteroids)
Asteroids[,2:8]
c(rep(1,7),2)
fit_mgm <- mgm(data = Asteroids[,2:9],type = c(rep("g",7),"c"),levels = c(rep(1,7),2),k=2,lambdaSel = "CV",lambdaFolds= 3,ruleReg="AND",overparameterize = T)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids[1:3000,2:14]),
color = c("purple",rep("lightblue",13)),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids[,2:9]),
color = c("purple",rep("lightblue",13)),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
fit_mgm <- mgm(data = Asteroids[,2:9],type = c(rep("g",7),"c"),levels = c(rep(1,7),2),k=2,lambdaSel = "CV",lambdaFolds= 5,ruleReg="AND",overparameterize = T)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids[,2:9]),
color = c("purple",rep("lightblue",13)),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
qgraph(fit_mgm)
qgraph(fit_mgm$pairwise$wadj,)
qgraph(fit_mgm$pairwise$wadj)
View(fit_mgm)
fit_mgm $mpar.matrix
library(qgraph)
qgraph(fit_mgm $pairwise$wadj,edge.color = fit_mgm $pairwise$edgecolor,layout = "spring",labels =  Asteroids[,2:9]$colnames)
qgraph(fit_mgm $pairwise$wadj,edge.color = fit_mgm $pairwise$edgecolor,layout = "spring",labels =  Asteroids$colnames)
fit_mgm$$interactions$indicator
fit_mgm$interactions$indicator
pred_obj <- predict(fit_mgm, Asteroids[,2:9]$data)
pred_obj <- predict(fit_mgm, Asteroids[,2:9])
View(pred_obj)
pred_obj[["predicted"]]
fit_mgm <- mgm(data = Asteroids[1:4000,2:9],type = c(rep("g",7),"c"),levels = c(rep(1,7),2),k=2,lambdaSel = "CV",lambdaFolds= 5,ruleReg="AND",overparameterize = T)
pred_obj <- predict(fit_mgm, Asteroids[4001:5000,2:9])
pred_obj <- predict(fit_mgm, Asteroids[4001:5000,2:8])
pred_obj <- predict(fit_mgm, Asteroids[4001:5000,2:7])
pred_obj <- predict(fit_mgm, Asteroids[4001:5000,])
Asteroids[4001:5000,2:8]
pred_obj <- predict(fit_mgm, Asteroids[4001:5000,2:8])
fit_mgm <- mgm(data = Asteroids[1:4000,2:9],type = c(rep("g",7),"c"),levels = c(rep(1,7),2),k=2,lambdaSel = "CV",lambdaFolds= 5,ruleReg="AND",overparameterize = T)
qgraph(fit_mgm$pairwise$wadj,edge.color = fit_mgm $pairwise$edgecolor,layout = "spring",labels =  Asteroids$colnames)
pred_obj <- predict(fit_mgm, Asteroids[4001:5000,2:8])
d_obj <- predict(fit_mgm, Asteroids[4001:5000,2:9])
pred_obj <- predict(fit_mgm, Asteroids[4001:5000,2:9])
pred_obj <- predict(fit_mgm, Asteroids[1:4000,2:9])
View(pred_obj)
pred_obj[["errors"]]
Asteroids <- read_excel("Dataset/Asteroids_REF.xlsx")
Asteroids[sapply(Asteroids, is.character)]  <- lapply(Asteroids[sapply(Asteroids, is.character)], as.factor)
Asteroids[2:8] <- lapply(Asteroids[2:8], as.numeric)
View(Asteroids)
fit_mgm <- mgm(data = Asteroids[1:1512,2:9],type = c(rep("g",7),"c"),levels = c(rep(1,7),2),k=2,lambdaSel = "CV",lambdaFolds= 5,ruleReg="AND",overparameterize = T)
qgraph(fit_mgm$pairwise$wadj,edge.color = fit_mgm $pairwise$edgecolor,layout = "spring",labels =  Asteroids$colnames)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames( Asteroids[1:1512,2:9]),
color = c("purple",rep("lightblue",13)),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
pred_obj <- predict(fit_mgm, Asteroids[1:1512,2:9])
pred_obj[["errors"]]
fit_mgm <- mgm(data = Asteroids[1:1512,2:9],type = c(rep("g",7),"c"),levels = c(rep(1,7),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph(fit_mgm$pairwise$wadj,edge.color = fit_mgm $pairwise$edgecolor,layout = "spring",labels =  Asteroids$colnames)
pred_obj <- predict(fit_mgm, Asteroids[1:1512,2:9])
pred_obj[["errors"]]
fit_mgm <- mgm(data = Asteroids[1:2267,2:9],type = c(rep("g",7),"c"),levels = c(rep(1,7),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph(fit_mgm$pairwise$wadj,edge.color = fit_mgm $pairwise$edgecolor,layout = "spring",labels =  Asteroids$colnames)
pred_obj <- predict(fit_mgm, Asteroids[1:2267,2:9])
pred_obj[["errors"]]
Asteroids <- read_excel("Dataset/Asteroids_REF.xlsx")
fit_mgm <- mgm(data = Asteroids[1:2267,2:10],type = c(rep("g",7),"c"),levels = c(rep(1,7),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
fit_mgm <- mgm(data = Asteroids[1:2267,2:10],type = c(rep("g",9),"c"),levels = c(rep(1,9),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
Asteroids[1:2267,2:10]
fit_mgm <- mgm(data = Asteroids[1:2267,2:11],type = c(rep("g",9),"c"),levels = c(rep(1,9),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
Asteroids <- read_excel("Dataset/Asteroids_REF.xlsx")
fit_mgm <- mgm(data = Asteroids[1:2267,2:11],type = c(rep("g",9),"c"),levels = c(rep(1,9),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph(fit_mgm$pairwise$wadj,edge.color = fit_mgm $pairwise$edgecolor,layout = "spring",labels =  Asteroids$colnames)
pred_obj <- predict(fit_mgm, Asteroids[1:2267,2:9])
pred_obj <- predict(fit_mgm, Asteroids[1:2267,2:11])
pred_obj[["errors"]]
fit_mgm <- mgm(data = Asteroids[1:5000,2:11],type = c(rep("g",9),"c"),levels = c(rep(1,9),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
fit_mgm <- mgm(data = Asteroids[1:4000,2:11],type = c(rep("g",9),"c"),levels = c(rep(1,9),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph(fit_mgm$pairwise$wadj,edge.color = fit_mgm $pairwise$edgecolor,layout = "spring",labels =  Asteroids$colnames)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames( Asteroids[1:1512,2:9]),
color = c("purple",rep("lightblue",13)),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids[1:2267,2:11] ),
color = c("purple",rep("lightblue",13)),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
Asteroids <- read_excel("Dataset/Asteroids_REF.xlsx")
fit_mgm <- mgm(data = Asteroids[1:4000,2:11],type = c(rep("g",9),"c"),levels = c(rep(1,9),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph(fit_mgm$pairwise$wadj,edge.color = fit_mgm $pairwise$edgecolor,layout = "spring",labels =  Asteroids$colnames)
pred_obj <- predict(fit_mgm, Asteroids[1:2267,2:11])
pred_obj[["errors"]]
library(readxl)
library(gRim)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(bnlearn)
library(gRapHD)
library(qgraph)
Asteroids <- read_excel("Dataset/Asteroids_REF.xlsx")
fit_mgm <- mgm(data = Asteroids[1:4000,2:11],type = c(rep("g",9),"c"),levels = c(rep(1,9),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
pred_obj <- predict(fit_mgm, Asteroids[1:2267,2:11])
pred_obj[["errors"]]
dag = hc(Asteroids[1:4000,2:11])
fit = bn.fit(dag, Asteroids[1:4000,2:11])
fit = bn.fit(dag, Asteroids[1:4000,2:11])
plot(fit)
?`bn.fit plots`
bn.fit.qqplot(fit)
bn.fit.qqplot(fit)
?`bn.fit plots`
library(Rgraphviz)
plot(fit)
plot(dag)
View(fit)
graphviz.plot(dag, shape = "ellipse", highlight = list(arcs = wl))
graphviz.plot(dag, shape = "ellipse")
dag = hc(Asteroids[1:4000,2:11],debug = TRUE)
fit = bn.fit(dag, Asteroids[1:4000,2:11])
plot(as(amat(dag),"graphNEL"),)
plot(as(amat(dag),"graphNEL"),)
graphviz.plot(dag, shape = "ellipse")
dag = mmhc(Asteroids[1:4000,2:11])
graphviz.plot(dag, shape = "ellipse")
fitDag(amat(dag),S.carc,nrow(dag))
library(bnlearn)
fitDag(amat(dag),S.carc,nrow(dag))
dag = mmhc(Asteroids[1:4000,2:11],threshold=0.1,graph = TRUE)
dag = mmhc.skel(Asteroids[1:4000,2:11],threshold=0.1,graph = TRUE)
dag = mmhc(Asteroids[1:4000,2:11])
plot(as(amat(dag),"graphNEL"),)
dag = mmhc(Asteroids[1:4000,2:11])
graphviz.plot(dag, shape = "ellipse")
dag = rsmax2(Asteroids[1:4000,2:11])
graphviz.plot(dag, shape = "ellipse")
graphviz.plot(dag, shape = "ellipse")
dag = h2pc(Asteroids[1:4000,2:11])
plot(as(amat(dag),"graphNEL"),)
graphviz.plot(dag, shape = "ellipse")
dag = mmhc(Asteroids[1:4000,2:11])
plot(as(amat(dag),"graphNEL"),)
graphviz.plot(dag, shape = "ellipse")
dag = mmhc(Asteroids[1:4000,2:11],whitelist = c("Speed", "Mean_motion"))
plot(as(amat(dag),"graphNEL"),)
graphviz.plot(dag, shape = "ellipse")
dag = mmhc(Asteroids[1:4000,2:11],whitelist = c(3, 10))
dag = mmhc(Asteroids[1:4000,2:11],whitelist = c("3", "10"))
dag = mmhc(Asteroids[1:4000,2:11],whitelist = c(3, 10))
dag = mmhc(Asteroids[1:4000,2:11],whitelist = list(3,10))
list(3,10)
peppo<-list(3,10)
View(peppo)
dag = mmhc(Asteroids[1:4000,2:11],whitelist = r(3,10))
plot(as(amat(dag),"graphNEL"),)
graphviz.plot(dag, shape = "ellipse")
dag = mmhc(Asteroids[1:4000,2:11],whitelist = c(3,10))
plot(as(amat(dag),"graphNEL"),)
graphviz.plot(dag, shape = "ellipse")
dag = mmhc(Asteroids[1:4000,2:11],whitelist = l(3,10))
whitelist <- read_excel("Whitelist.xlsx")
View(whitelist)
dag = mmhc(Asteroids[1:4000,2:11],whitelist = whitelist)
whitelist <- read_excel("Whitelist.xlsx")
dag = mmhc(Asteroids[1:4000,2:11],whitelist = whitelist)
dag = mmhc(Asteroids[1:4000,2:11],whitelist = data.frame(from = "Speed", to = "Mean_motion"))
whitelist <- read_excel("Whitelist.xlsx")
View(whitelist)
dag = mmhc(Asteroids[1:4000,2:11],whitelist = whitelist)
graphviz.plot(dag, shape = "ellipse")
whitelist <- read_excel("Whitelist.xlsx")
dag = mmhc(Asteroids[1:4000,2:11],whitelist = whitelist)
plot(as(amat(dag),"graphNEL"),)
graphviz.plot(dag, shape = "ellipse")
whitelist <- read_excel("Whitelist.xlsx")
View(whitelist)
dag = mmhc(Asteroids[1:4000,2:11],whitelist = whitelist)
View(Asteroids)
View(whitelist)
View(Asteroids)
Asteroids[2:8] <- lapply(Asteroids[2:8], as.numeric)
dag = mmhc(Asteroids[1:4000,2:11],whitelist = whitelist)
whitelist <- read_excel("Whitelist.xlsx")
dag = mmhc(Asteroids[1:4000,2:11],whitelist = whitelist)
View(Asteroids)
whitelist <- read_excel("Whitelist.xlsx")
dag = mmhc(Asteroids[1:4000,2:11],whitelist = whitelist)
wl = matrix(c("A", "B", "B", "A", "B", "C", "C", "B",
+        "C", "A", "A", "C"), ncol = 2, byrow = TRUE)
wl = matrix(c("A", "B", "B", "A", "B", "C", "C", "B,"C", "A", "A", "C"), ncol = 2, byrow = TRUE)
wl = matrix(c("A", "B", "B", "A"), ncol = 2, byrow = TRUE)
View(wl)
wl = matrix(c("Speed
", "Mean_Motion", "Mean_Motion", "Semi_Major_Axis"), ncol = 2, byrow = TRUE)
View(wl)
wl = matrix(c("Speed", "Mean_Motion", "Mean_Motion", "Semi_Major_Axis"), ncol = 2, byrow = TRUE)
dag = mmhc(Asteroids[1:4000,2:11],whitelist = wl)
", "Mean_Motion", "Mean_Motion", "Semi_Major_Axis"), ncol = 2, byrow = TRUE)
wl = matrix(c("Speed", "Mean_Motion", "Mean_Motion", "Semi_Major_Axis"), ncol = 2, byrow = TRUE)
dag = mmhc(Asteroids[1:4000,2:11],whitelist = wl)
graphviz.plot(dag, shape = "ellipse")
wl = matrix(c("Speed", "Mean_Motion", "Mean_Motion", "Hazardous"), ncol = 2, byrow = TRUE)
dag = mmhc(Asteroids[1:4000,2:11],whitelist = wl)
plot(as(amat(dag),"graphNEL"),)
graphviz.plot(dag, shape = "ellipse")
wl = matrix(c("Mean_Motion", "Hazardous"), ncol = 2, byrow = TRUE)
dag = mmhc(Asteroids[1:4000,2:11],whitelist = wl)
plot(as(amat(dag),"graphNEL"),)
graphviz.plot(dag, shape = "ellipse")
library(readxl)
library(gRim)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
Asteroids <- read_excel("Dataset/Asteroids_REF.xlsx")
fit_mgm <- mgm(data = Asteroids[1:4000,2:11],type = c(rep("g",9),"c"),levels = c(rep(1,9),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids[1:2267,2:11] ),
color = c("purple",rep("lightblue",13)),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids[1:2267,2:11] ),
color = c(rep("lightblue",10),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids[1:2267,2:11] ),
color = c(rep("lightblue",9),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
