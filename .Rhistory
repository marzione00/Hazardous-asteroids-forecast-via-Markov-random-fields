plot(as(thresh.asteroids,"igraph"))
psin.asteroids<-sinUG(S.asteroids,n=nrow(Asteroids_FINAL_double[,-21]))
plotUGpvalues(psin.asteroids)
Zp<-psin.asteroids
Zp[]<-0
Zp[psin.asteroids<0.05]<- 1
g.p05<-as(Zp,"graphNEL")
pval105.asteroids <-cmod(edgeList(g.p05),data=Asteroids_FINAL_double[,-21])
plot(as(pval105.asteroids,"igraph"))
gsin.asteroids <-as(getgraph(psin.asteroids,0.1),"graphNEL")
plot(as(gsin.asteroids,"igraph"))
#S.body<- cov.wt(Asteroids_FINAL_double[,-21])$cov
C.asteroids  <- cov2cor(S.asteroids )
res.lasso <- glasso(C.asteroids , rho=0.3)
AM <- res.lasso$wi!=0
diag(AM)<-FALSE
g.lasso <- as(AM,"graphNEL")
nodes(g.lasso)<-names(Asteroids_FINAL_double[,-21])
glasso.asteroids <- cmod(edgeList(g.lasso),data=Asteroids_FINAL_double[,-21])
plot(as(glasso.asteroids ,"igraph"))
ciccio<-as(msx2,"graphNEL")
commonedges.asteroids <-as(msx2,"graphNEL")
othermodels<-list(gsin.asteroids ,thresh.asteroids ,msx2)
othermodels<-lapply(othermodels,as,"graphNEL")
for(i in 1:length(othermodels)) {
commonedges.asteroids  <- graph::intersection(commonedges.asteroids ,othermodels[[i]])
}
plot(as(commonedges.carc,"igraph"))
ciccio<-as(msx2,"graphNEL")
commonedges.asteroids <-as(msx2,"graphNEL")
othermodels<-list(gsin.asteroids ,thresh.asteroids ,msx2)
othermodels<-lapply(othermodels,as,"graphNEL")
for(i in 1:length(othermodels)) {
commonedges.asteroids  <- graph::intersection(commonedges.asteroids ,othermodels[[i]])
}
plot(as(commonedges.asteroids ,"igraph"))
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(gRim)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
library(caret)
library(pROC)
library(ROCR)
library(ggplot2)
library(FactoMineR)
library(factoextra)
library(ggplot2)
library(ggpubr)
library(gRapHD)
library(glasso)
library(SIN)
load("Asteroids_FINAL.rda")
Asteroids_FINAL[,2:21]<-scale(Asteroids_FINAL[,2:21])
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
msx<-cmod(~.^1.,data=Asteroids_FINAL_double[,-21])
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids_FINAL_double[,-21])),details=1)
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
S.asteroids <- cov.wt(Asteroids_FINAL_double[,-21], method="ML")$cov
K.asteroids <- solve(S.asteroids)
round(100*K.asteroids)
PC.asteroids <-cov2pcor(S.asteroids)
round(PC.asteroids*100)
round(100*PC.asteroids)
threeshold <-0.1
Z<-abs(PC.asteroids)
Z[Z<threeshold] <- 0
diag(Z) <- 0
Z[Z>0] <- 1
g.thresh <- as(Z,"graphNEL")
thresh.asteroids <- cmod(edgeList(g.thresh ), data=Asteroids_FINAL_double[,-21])
thresh.asteroids
plot(as(thresh.asteroids,"igraph"))
psin.asteroids<-sinUG(S.asteroids,n=nrow(Asteroids_FINAL_double[,-21]))
plotUGpvalues(psin.asteroids)
Zp<-psin.asteroids
Zp[]<-0
Zp[psin.asteroids<0.05]<- 1
g.p05<-as(Zp,"graphNEL")
pval105.asteroids <-cmod(edgeList(g.p05),data=Asteroids_FINAL_double[,-21])
plot(as(pval105.asteroids,"igraph"))
gsin.asteroids <-as(getgraph(psin.asteroids,0.1),"graphNEL")
plot(as(gsin.asteroids,"igraph"))
#S.body<- cov.wt(Asteroids_FINAL_double[,-21])$cov
C.asteroids  <- cov2cor(S.asteroids )
res.lasso <- glasso(C.asteroids , rho=0.3)
AM <- res.lasso$wi!=0
diag(AM)<-FALSE
g.lasso <- as(AM,"graphNEL")
nodes(g.lasso)<-names(Asteroids_FINAL_double[,-21])
glasso.asteroids <- cmod(edgeList(g.lasso),data=Asteroids_FINAL_double[,-21])
plot(as(glasso.asteroids ,"igraph"))
commonedges.asteroids <-as(msx2,"graphNEL")
othermodels<-list(gsin.asteroids ,thresh.asteroids ,msx2)
othermodels<-lapply(othermodels,as,"graphNEL")
for(i in 1:length(othermodels)) {
commonedges.asteroids  <- graph::intersection(commonedges.asteroids ,othermodels[[i]])
}
plot(as(commonedges.asteroids ,"igraph"))
install.packages("gRain")
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(gRim)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
library(caret)
library(pROC)
library(ROCR)
library(ggplot2)
library(FactoMineR)
library(factoextra)
library(ggplot2)
library(ggpubr)
library(gRapHD)
library(glasso)
library(SIN)
library(gRain)
load("Asteroids_FINAL.rda")
Asteroids_FINAL[,2:21]<-scale(Asteroids_FINAL[,2:21])
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
msx<-cmod(~.^1.,data=Asteroids_FINAL_double[,-21])
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids_FINAL_double[,-21])),details=1)
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
S.asteroids <- cov.wt(Asteroids_FINAL_double[,-21], method="ML")$cov
K.asteroids <- solve(S.asteroids)
round(100*K.asteroids)
PC.asteroids <-cov2pcor(S.asteroids)
round(PC.asteroids*100)
round(100*PC.asteroids)
threeshold <-0.1
Z<-abs(PC.asteroids)
Z[Z<threeshold] <- 0
diag(Z) <- 0
Z[Z>0] <- 1
g.thresh <- as(Z,"graphNEL")
thresh.asteroids <- cmod(edgeList(g.thresh ), data=Asteroids_FINAL_double[,-21])
thresh.asteroids
plot(as(thresh.asteroids,"igraph"))
psin.asteroids<-sinUG(S.asteroids,n=nrow(Asteroids_FINAL_double[,-21]))
plotUGpvalues(psin.asteroids)
Zp<-psin.asteroids
Zp[]<-0
Zp[psin.asteroids<0.05]<- 1
g.p05<-as(Zp,"graphNEL")
pval105.asteroids <-cmod(edgeList(g.p05),data=Asteroids_FINAL_double[,-21])
plot(as(pval105.asteroids,"igraph"))
gsin.asteroids <-as(getgraph(psin.asteroids,0.1),"graphNEL")
plot(as(gsin.asteroids,"igraph"))
#S.body<- cov.wt(Asteroids_FINAL_double[,-21])$cov
C.asteroids  <- cov2cor(S.asteroids )
res.lasso <- glasso(C.asteroids , rho=0.3)
AM <- res.lasso$wi!=0
diag(AM)<-FALSE
g.lasso <- as(AM,"graphNEL")
nodes(g.lasso)<-names(Asteroids_FINAL_double[,-21])
glasso.asteroids <- cmod(edgeList(g.lasso),data=Asteroids_FINAL_double[,-21])
plot(as(glasso.asteroids ,"igraph"))
commonedges.asteroids <-as(msx2,"graphNEL")
othermodels<-list(gsin.asteroids ,thresh.asteroids ,msx2)
othermodels<-lapply(othermodels,as,"graphNEL")
for(i in 1:length(othermodels)) {
commonedges.asteroids  <- graph::intersection(commonedges.asteroids ,othermodels[[i]])
}
plot(as(commonedges.asteroids ,"igraph"))
plot(as(glasso.asteroids ,"igraph"))
plot(as(commonedges.asteroids ,"igraph"))
grain(commonedges.asteroids)
extractPOT(commonedges.asteroids)
extractPOT(Asteroids_FINAL_double[,-21],triangulate(as(commonedges.asteroids ,"igraph")))
gm1 <- as_graphnel(as(commonedges.asteroids,"igraph"))
gm1 <- as_graphnel(as(commonedges.asteroids,"igraph"))
pot <- extractPOT(Asteroids_FINAL_double[,-21],gm1,smooth=0)
gm1 <- triangulate(as_graphnel(as(commonedges.asteroids,"igraph")))
pot <- extractPOT(Asteroids_FINAL_double[,-21],gm1,smooth=0)
library(randomForest)
library(randomForestExplainer)
install.packages("randomForest")
install.packages("randomForestExplainer")
library(randomForest)
library(randomForestExplainer)
RF_perf_out<-tuneRF(Asteroids_FINAL_double[,-21],Asteroids_FINAL_double[,21], ntree=5000)
RF_perf_out<-data.frame(RF_perf_out)
Asteroids_FINAL_double_train<- sample(3552,2344)
Asteroids_FINAL_double_test<-Asteroids_FINAL_double[-Planets_dataset_train,]
Asteroids_FINAL_double_train<- sample(3552,2344)
Asteroids_FINAL_double_test<-Asteroids_FINAL_double[-Asteroids_FINAL_double_train,]
Asteroids_FINAL_double.columns
colnames(Asteroids_FINAL_double)
RF_perf_out<-tuneRF(Asteroids_FINAL_double_train[,-21],Asteroids_FINAL_double_train[,21], ntree=5000)
RF_perf_out<-data.frame(RF_perf_out)
rfor.planet <-randomForest(Hazardous~Absolute_Magnitude+Est.Dia.in.KM.min.+Est.Dia.in.KM.max.+Close.Approach.Date+Epoch.Date.Close.Approach+Relative_Velocity+Miss_Dist+Min_Orbit_Intersection+Jupiter_Tisserand_Invariant+Epoch_Osculation+Eccentricity+Semi.Major.Axis+Inclination+Asc.Node.Longitude+Orbital.Period+,data=Asteroids_FINAL_double+Perihelion.Distance+Perihelion.Arg+Perihelion.Time+Mean_Anomaly+Mean_Anomaly, subset=Asteroids_FINAL_double_train,localImp = TRUE,importance=TRUE,proximity=TRUE,ntry=4)
RF_perf_out<-tuneRF(Asteroids_FINAL_double_train[,-21],Asteroids_FINAL_double_train[,21], ntree=5000)
RF_perf_out<-data.frame(RF_perf_out)
rfor.planet <-randomForest(Hazardous~Absolute_Magnitude+Est.Dia.in.KM.min.+Est.Dia.in.KM.max.+Close.Approach.Date+Epoch.Date.Close.Approach+Relative_Velocity+Miss_Dist+Min_Orbit_Intersection+Jupiter_Tisserand_Invariant+Epoch_Osculation+Eccentricity+Semi.Major.Axis+Inclination+Asc.Node.Longitude+Orbital.Period,data=Asteroids_FINAL_double+Perihelion.Distance+Perihelion.Arg+Perihelion.Time+Mean_Anomaly+Mean_Anomaly, subset=Asteroids_FINAL_double_train,localImp = TRUE,importance=TRUE,proximity=TRUE,ntry=4)
RF_perf_out<-data.frame(RF_perf_out)
rfor.planet <-randomForest(Hazardous~Absolute_Magnitude+Est.Dia.in.KM.min.+Est.Dia.in.KM.max.+Close.Approach.Date+Epoch.Date.Close.Approach+Relative_Velocity+Miss_Dist+Min_Orbit_Intersection+Jupiter_Tisserand_Invariant+Epoch_Osculation+Eccentricity+Semi.Major.Axis+Inclination+Asc.Node.Longitude+Orbital.Period,data=Asteroids_FINAL_double+Perihelion.Distance+Perihelion.Arg+Perihelion.Time+Mean_Anomaly+Mean_Anomaly, subset=Asteroids_FINAL_double_train,localImp = TRUE,importance=TRUE,proximity=TRUE,ntry=4)
colnames(Asteroids_FINAL_double_train)
rfor.planet <-randomForest(Hazardous~Absolute_Magnitude+Est.Dia.in.KM.min.+Est.Dia.in.KM.max.+Close.Approach.Date+Epoch.Date.Close.Approach+Relative_Velocity+Miss_Dist+Min_Orbit_Intersection+Jupiter_Tisserand_Invariant+Epoch_Osculation+Eccentricity+Semi.Major.Axis+Inclination+Asc.Node.Longitude+Orbital.Period,data=Asteroids_FINAL_double+Perihelion.Distance+Perihelion.Arg+Perihelion.Time+Mean_Anomaly+Mean_Anomaly,data=Asteroids_FINAL_double,subset=Asteroids_FINAL_double_train,localImp = TRUE,importance=TRUE,proximity=TRUE,ntry=4)
rfor.planet <-randomForest(Hazardous~.,data=Asteroids_FINAL_double,subset=Asteroids_FINAL_double_train,localImp = TRUE,importance=TRUE,proximity=TRUE,ntry=4)
RF_perf_out<-tuneRF(Asteroids_FINAL_double_train[,-21],Asteroids_FINAL_double_train[,21], ntree=5000)
RF_perf_out<-data.frame(RF_perf_out)
rfor.planet <-randomForest(Hazardous~.,data=Asteroids_FINAL_double,subset=Asteroids_FINAL_double_train,localImp = TRUE,importance=TRUE,proximity=TRUE,ntry=4)
rfor.predict<-data.frame(predict(rfor.planet, Asteroids_FINAL_double_test, type = "class"))
var_imp_rforest<-data.frame(varImp(rfor.planet))
colnames(var_imp_rforest)<-c("Variable","Overall")
var_imp_rforest[,1]<-rownames(var_imp_rforest)
rownames(var_imp_rforest)<-seq(1:13)
var_imp_rforest<-data.frame(varImp(rfor.planet))
colnames(var_imp_rforest)<-c("Variable","Overall")
var_imp_rforest<-data.frame(varImp(rfor.planet))
colnames(var_imp_rforest)<-c("Variable","Overall")
var_imp_rforest[,1]<-rownames(var_imp_rforest)
rownames(var_imp_rforest)<-seq(1:21)
var_imp_rforest<-data.frame(varImp(rfor.planet))
colnames(var_imp_rforest)<-c("Variable","Overall")
var_imp_rforest[,1]<-rownames(var_imp_rforest)
rownames(var_imp_rforest)<-seq(1:20)
ggplot(var_imp_rforest, aes(y=reorder(Variable,Overall),x=Overall,color="red")) +
geom_point() +
geom_segment(aes(x=0,xend=Overall,yend=Variable)) +
scale_color_discrete(name="Variable Group") +
xlab("Overall importance") +
ylab("Variable Name") + guides(color = FALSE, size = FALSE) + theme_bw()
plot(rfor.planet)
tree_plot<-data.frame(rfor.planet[["err.rate"]])
tree_plot[4]<-seq(1:500)
colnames(tree_plot)<-c("OOB","Not_habitable","Habitable","Trees")
ggplot() + geom_line(data = tree_plot, aes(x = Trees, y = OOB,color = "OOB") ) +
geom_line(data = tree_plot, aes(x = Trees, y = Not_habitable,color = "Not H") ) +
geom_line(data = tree_plot, aes(x = Trees, y = Habitable,color = "H") )+labs(color = "Legend")+theme() + xlab('Trees') + ylab('Error')+theme_bw()
plot(rfor.planet)
legend("top", colnames(rfor.planet$err.rate), fill=1:ncol(rfor.planet$err.rate))
varImpPlot(rfor.planet)
proximityPlot(rfor.planet)
print(rfor.planet)
rfor.predict["Test"]<-as.factor(Planets_dataset_test[,12])
colnames(rfor.predict)<-c("Predict","Test")
fourfoldplot(table(rfor.predict), color = c("red","darkgreen"),conf.level = 0, margin = 1, main = "Random Forest")
pred_for<-prediction(as.numeric(rfor.predict$Predict),as.numeric(rfor.predict$Test))
roc_for.perf <- performance(pred_for, measure = "tpr", x.measure = "fpr")
autoplot(roc_for.perf)+theme_bw()
fourfoldplot(table(rfor.predict), color = c("red","darkgreen"),conf.level = 0, margin = 1, main = "Random Forest")
rfor.predict["Test"]<-as.factor(Planets_dataset_test[,12])
colnames(rfor.predict)<-c("Predict","Test")
rfor.predict["Test"]<-as.factor(Asteroids_FINAL_double_test[,21])
colnames(rfor.predict)<-c("Predict","Test")
fourfoldplot(table(rfor.predict), color = c("red","darkgreen"),conf.level = 0, margin = 1, main = "Random Forest")
fourfoldplot(table(rfor.predict), color = c("red","darkgreen"),main = "Random Forest")
fourfoldplot(table(rfor.predict), color = c("red","darkgreen"),main = "Random Forest")
tune_svm_full.out<-tune(svm ,Hazardous~.,data=data=Asteroids_FINAL_double[Asteroids_FINAL_double_train,], type = 'C-classification',kernel="polynomial",
ranges =list(cost=(1:10),degree=(1:5)))
print(tune_svm_full.out)
tune_svm_full.out<-tune(svm ,Hazardous~.,data=Asteroids_FINAL_double[Asteroids_FINAL_double_train,], type = 'C-classification',kernel="polynomial",
ranges =list(cost=(1:10),degree=(1:5)))
print(tune_svm_full.out)
install.packages("e1071")
library(e1071)
tune_svm_full.out<-tune(svm ,Hazardous~.,data=Asteroids_FINAL_double[Asteroids_FINAL_double_train,], type = 'C-classification',kernel="polynomial",
ranges =list(cost=(1:10),degree=(1:5)))
print(tune_svm_full.out)
perf_svm<-data.frame(tune_svm_full.out[["performances"]])
ggplot(perf_svm,aes(x=cost,y=degree, z=error))+geom_line(color="red",linetype="dashed")+geom_point(color="red")+theme_bw()
svm.full <- svm(Hazardous~., data=Asteroids_FINAL_double[Asteroids_FINAL_double_train,],type = 'C-classification', kernel="polynomial",cost=10,degree=3,)
svm.predict_full<-data.frame(predict(svm.full,Asteroids_FINAL_double[Asteroids_FINAL_double_train,],type = "class"))
svm.predict_full["T"]<-as.factor(Asteroids_FINAL_double_test[,21])
svm_fin_full<-data.frame(svm.predict_full,stringsAsFactors = TRUE)
colnames(svm_fin_full)<-c("Predict","Test")
caret::confusionMatrix(table(svm_fin_full))
fourfoldplot(table(svm_fin_full), color = c("red","darkgreen"),conf.level = 0, margin = 1, main = "SVM_FULL")
svm.predict_full["T"]<-as.factor(Asteroids_FINAL_double_test[,21])
svm.predict_full<-data.frame(predict(svm.full,Asteroids_FINAL_double[Asteroids_FINAL_double_train,],type = "class"))
svm.predict_full["T"]<-as.factor(Asteroids_FINAL_double_test[,21])
svm.predict_full<-data.frame(predict(svm.full,Asteroids_FINAL_double[-Asteroids_FINAL_double_train,],type = "class"))
svm.predict_full["T"]<-as.factor(Asteroids_FINAL_double_test[,21])
svm_fin_full<-data.frame(svm.predict_full,stringsAsFactors = TRUE)
colnames(svm_fin_full)<-c("Predict","Test")
caret::confusionMatrix(table(svm_fin_full))
fourfoldplot(table(svm_fin_full), color = c("red","darkgreen"),conf.level = 0, margin = 1, main = "SVM_FULL")
qda.planet<- qda(Hazardous~., data=Asteroids_FINAL_double, subset=Asteroids_FINAL_double_train)
install.packages("MASS")
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(gRim)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
library(caret)
library(pROC)
library(ROCR)
library(ggplot2)
library(FactoMineR)
library(factoextra)
library(ggplot2)
library(ggpubr)
library(gRapHD)
library(glasso)
library(SIN)
library(gRain)
library(randomForest)
library(randomForestExplainer)
library(e1071)
library(MASS)
qda.planet<- qda(Hazardous~., data=Asteroids_FINAL_double, subset=Asteroids_FINAL_double_train)
qda.planet<- qda(Hazardous~., data=Asteroids_FINAL_double, subset=Asteroids_FINAL_double_train)
qda.prob<-data.frame(predict(qda.planet,Asteroids_FINAL_double[-Asteroids_FINAL_double,],type = "response"))
qda.prob<-qda.prob["class"]
qda_fin<-data.frame(qda.prob,stringsAsFactors = TRUE)
qda_fin["Test"]<-as.factor(Planets_dataset[-Asteroids_FINAL_double,12])
colnames(qda_fin)<-c("Predict","Test")
caret::confusionMatrix(table(qda_fin))
fourfoldplot(table(qda_fin), color = c("red","darkgreen"),conf.level = 0, margin = 1, main = "QDA")
qda.planet<- qda(Hazardous~., data=Asteroids_FINAL_double, subset=Asteroids_FINAL_double_train)
qda.prob<-data.frame(predict(qda.planet,Asteroids_FINAL_double[-Asteroids_FINAL_double,],type = "response"))
qda.prob<-qda.prob["class"]
qda_fin<-data.frame(qda.prob,stringsAsFactors = TRUE)
qda_fin["Test"]<-as.factor(Asteroids_FINAL_doublet[-Asteroids_FINAL_double_train,21])
qda.prob<-data.frame(predict(qda.planet,Asteroids_FINAL_double[-Asteroids_FINAL_double,],type = "response"))
qda.prob<-qda.prob["class"]
qda.prob<-data.frame(predict(qda.planet,Asteroids_FINAL_double[-Asteroids_FINAL_double,],type = "response"))
qda.prob<-data.frame(predict(qda.planet,Asteroids_FINAL_double[-Asteroids_FINAL_double_train,],type = "response"))
qda.prob<-qda.prob["class"]
qda_fin<-data.frame(qda.prob,stringsAsFactors = TRUE)
qda_fin["Test"]<-as.factor(Asteroids_FINAL_doublet[-Asteroids_FINAL_double_train,21])
colnames(qda_fin)<-c("Predict","Test")
caret::confusionMatrix(table(qda_fin))
fourfoldplot(table(qda_fin), color = c("red","darkgreen"),conf.level = 0, margin = 1, main = "QDA")
qda_fin<-data.frame(qda.prob,stringsAsFactors = TRUE)
qda_fin["Test"]<-as.factor(Asteroids_FINAL_doublet[-Asteroids_FINAL_double_train,21])
qda_fin<-data.frame(qda.prob,stringsAsFactors = TRUE)
qda_fin["Test"]<-as.factor(Asteroids_FINAL_double[-Asteroids_FINAL_double_train,21])
colnames(qda_fin)<-c("Predict","Test")
caret::confusionMatrix(table(qda_fin))
fourfoldplot(table(qda_fin), color = c("red","darkgreen"),conf.level = 0, margin = 1, main = "QDA")
pred_qda<-prediction(as.numeric(qda_fin$Predict),as.numeric(qda_fin$Test))
roc_qda.perf <- performance(pred_qda, measure = "tpr", x.measure = "fpr")
phi_qda<-performance(pred_qda, "phi")
plot(phi_qda)
fourfoldplot(table(svm_fin_full), color = c("red","darkgreen"),conf.level = 0, margin = 1, main = "SVM_FULL")
pred_svm_full<-prediction(as.numeric(svm_fin_full$Predict),as.numeric(svm_fin_full$Test))
roc_svm_full.perf <- performance(pred_svm_full, measure = "tpr", x.measure = "fpr")
phi_svm_full<-performance(pred_svm_full, "mi")
phi_svm_full@y.values
autoplot(roc_svm_full.perf)+theme_bw()
caret::confusionMatrix(table(svm_fin_full))
fit_mgm <- mgm(data = Asteroids_FINAL[,-1],type = c(rep("g",20),"c"),levels = c(rep(1,20),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
pred_obj <- predict(fit_mgm, Asteroids_FINAL[,-1])
Predicted_vs_real<-as.data.frame(pred_obj[["predicted"]][,21])
Predicted_vs_real<-as.data.frame(as.factor(Predicted_vs_real$`pred_obj[["predicted"]][, 21]`))
colnames(Predicted_vs_real)<-c("PRED")
levels(Predicted_vs_real$PRED) <- c('FALSE', 'TRUE')
conf<-data.frame(lapply(Asteroids_FINAL[,22], as.factor),Predicted_vs_real)
Confusion_matrix_ASTEROIDS<-confusionMatrix(conf$Hazardous,conf$PRED)
Confusion_matrix_ASTEROIDS
model <- glm(Hazardous~.,family=binomial(link='logit'),data=Asteroids_FINAL_double)
summary(model)
logistic.prob<-data.frame(predict(model ,Asteroids_FINAL_double[-Asteroids_FINAL_double_train,],type = "response"))
colnames(logistic.prob)<-c("P")
logistic.prob<- data.frame(ifelse(logistic.prob > 0.5, "True", "False"))
logistic.prob["T"]<-as.factor(Planets_dataset[-Planets_dataset_train,12])
logistic.prob<- data.frame(ifelse(logistic.prob > 0.5, "True", "False"))
logistic.prob["T"]<-as.factor(Planets_dataset[-Asteroids_FINAL_doublet_train,21])
logistic.prob<- data.frame(ifelse(logistic.prob > 0.5, "True", "False"))
logistic.prob["T"]<-as.factor(Asteroids_FINAL_double[-Asteroids_FINAL_doublet_train,21])
colnames(logistic.prob)<-c("P")
logistic.prob<- data.frame(ifelse(logistic.prob > 0.5, "True", "False"))
logistic.prob["T"]<-as.factor(Asteroids_FINAL_double[-Asteroids_FINAL_double_train,21])
fourfoldplot(table(logistic.prob), color = c("red","darkgreen"),conf.level = 0, margin = 1, main = "Logistic")
model <- glm(Hazardous~.,family=binomial(link='logit'),data=Asteroids_FINAL_double)
summary(model)
logistic.prob<-data.frame(predict(model ,Asteroids_FINAL_double[-Asteroids_FINAL_double_train,],type = "response"))
colnames(logistic.prob)<-c("P")
logistic.prob<- data.frame(ifelse(logistic.prob > 0.5, "True", "False"))
logistic.prob["T"]<-as.factor(Asteroids_FINAL_double[-Asteroids_FINAL_double_train,21])
fourfoldplot(table(logistic.prob), color = c("red","darkgreen"), main = "Logistic")
caret::confusionMatrix(table(logistic.prob))
View(logistic.prob)
caret::confusionMatrix(logistic.prob)
table(logistic.prob)
fourfoldplot(table(logistic.prob), color = c("red","darkgreen"), main = "Logistic")
colnames(logistic.prob)<-c("P","T")
fourfoldplot(table(logistic.prob), color = c("red","darkgreen"), main = "Logistic")
caret::confusionMatrix(table(logistic.prob))
colnames(logistic.prob)<-c("P")
logistic.prob<- data.frame(ifelse(logistic.prob > 0.5, "T", "F"))
logistic.prob["T"]<-as.factor(Asteroids_FINAL_double[-Asteroids_FINAL_double_train,21])
colnames(logistic.prob)<-c("P","T")
fourfoldplot(table(logistic.prob), color = c("red","darkgreen"), main = "Logistic")
caret::confusionMatrix(table(logistic.prob))
fourfoldplot(table(logistic.prob), color = c("red","darkgreen"), main = "Logistic")
View(logistic.prob)
logistic.prob<-data.frame(predict(model ,Asteroids_FINAL_double[-Asteroids_FINAL_double_train,],type = "response"))
colnames(logistic.prob)<-c("P")
logistic.prob<- data.frame(ifelse(logistic.prob > 0.5, "T", "F"))
logistic.prob
logistic.prob<- data.frame(ifelse(logistic.prob > 0.5, "T", "F"))
logistic.prob["T"]<-as.factor(Asteroids_FINAL_double[-Asteroids_FINAL_double_train,21])
logistic.prob
table(logistic.prob)
logistic.prob["T"]<-as.factor(Asteroids_FINAL_double[-Asteroids_FINAL_double_train,21])
colnames(logistic.prob)<-c("P","T")
table(logistic.prob)
logistic.prob<-data.frame(predict(model ,Asteroids_FINAL_double[-Asteroids_FINAL_double_train,],type = "response"))
colnames(logistic.prob)<-c("P")
logistic.prob<- data.frame(ifelse(logistic.prob > 0.5, "T", "F"))
table(logistic.prob)
logistic.prob<-data.frame(predict(model ,Asteroids_FINAL_double[-Asteroids_FINAL_double_train,],type = "response"))
colnames(logistic.prob)<-c("P")
logistic.prob<- data.frame(ifelse(logistic.prob > 0.5, "True", "False"))
logistic.prob["T"]<-as.factor(Asteroids_FINAL_double[-Asteroids_FINAL_double_train,21])
table(logistic.prob)
colnames(logistic.prob)<-c("P","T")
table(logistic.prob)
logistic.prob<- data.frame(ifelse(logistic.prob > 0.5, "False", "True"))
logistic.prob["T"]<-as.factor(Asteroids_FINAL_double[-Asteroids_FINAL_double_train,21])
logistic.prob<-data.frame(predict(model ,Asteroids_FINAL_double[-Asteroids_FINAL_double_train,],type = "response"))
colnames(logistic.prob)<-c("P")
logistic.prob<- data.frame(ifelse(logistic.prob > 0.5, "True", "False"))
logistic.prob["T"]<-as.factor(Asteroids_FINAL_double[-Asteroids_FINAL_double_train,21])
logistic.prob<-data.frame(predict(model ,Asteroids_FINAL_double[-Asteroids_FINAL_double_train,],type = "response"))
colnames(logistic.prob)<-c("P")
logistic.prob<- data.frame(ifelse(logistic.prob > 0.5, "1", "0"))
logistic.prob["T"]<-as.factor(Asteroids_FINAL_double[-Asteroids_FINAL_double_train,21])
colnames(logistic.prob)<-c("P","T")
caret::confusionMatrix(table(logistic.prob))
Confusion_matrix_ASTEROIDS
bf<-minForest(Asteroids_FINAL_double,homog=TRUE,forbEdges=NULL,stat="LR")
plot(bf)
mbG<-stepw(model=bf,data=Asteroids_FINAL_double,exact=TRUE)
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("red"),vert.hl=c(21),col.hl=c("blue"))
bf<-minForest(Asteroids_FINAL_double,homog=TRUE,forbEdges=NULL,stat="LR")
plot(bf)
bf<-minForest(Asteroids_FINAL_double,homog=TRUE,forbEdges=NULL,stat="LR")
plot(bf)
mbG<-stepw(model=bf,data=Asteroids_FINAL_double,exact=TRUE)
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("red"),vert.hl=c(21),col.hl=c("blue"))
mbG<-stepw(model=bf,data=Asteroids_FINAL_double,exact=TRUE)
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("red"),vert.hl=c(21),col.hl=c("blue"))
plot(mbG,cex.vert.label=0.8,numIter=6000,col.labels=c("red"),vert.hl=c(21),col.hl=c("blue"))
plot(mbG,cex.vert.label=0.8,numIter=6000,col.labels=c("red"),vert.hl=c(21),col.hl=c("blue"))
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(gRim)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
library(caret)
library(pROC)
library(ROCR)
library(ggplot2)
library(FactoMineR)
library(factoextra)
library(ggplot2)
library(ggpubr)
library(gRapHD)
library(glasso)
library(SIN)
library(gRain)
library(randomForest)
library(randomForestExplainer)
library(e1071)
library(MASS)
load("Asteroids_FINAL.rda")
Asteroids_FINAL[,2:21]<-scale(Asteroids_FINAL[,2:21])
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
fit_mgm <- mgm(data = Asteroids_FINAL[,-1],type = c(rep("g",20),"c"),levels = c(rep(1,20),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
fit_mgm$probabilties
View(fit_mgm)
pred_obj <- predict(fit_mgm, Asteroids_FINAL[,-1])
pred_obj$probabilties
head(round(pred_obj$probabilties[[1]],2))
head(round(pred_obj$probabilties[[1]]))
pred_obj$probabilties[[1]]
pred_obj$probabilties
View(pred_obj)
pred_obj[["probabilties"]][[21]]
head(round(pred_obj[["probabilties"]][[21]]]))
head(round(pred_obj[["probabilties"]][[21]]))
round(pred_obj[["probabilties"]][[21]])
round(pred_obj[["probabilties"]][[21]],2)
