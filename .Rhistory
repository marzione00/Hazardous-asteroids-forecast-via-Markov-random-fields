plot.igraph(as(msx2,'igraph'),edge.arrow.size=.5, vertex.color="gold", vertex.size=15,
vertex.frame.color="gray", vertex.label.color="black",
vertex.label.cex=1, vertex.label.dist=2, edge.curved=0.2)
plot.igraph(as(msx2,'igraph'),edge.arrow.size=.5, vertex.color="gold", vertex.size=15,
vertex.frame.color="gray", vertex.label.color="black",
vertex.label.cex=1, vertex.label.dist=3, edge.curved=0.2)
plot.igraph(as(msx2,'igraph'),edge.arrow.size=.5, vertex.color="gold", vertex.size=15,
vertex.frame.color="gray", vertex.label.color="black",
vertex.label.cex=1, vertex.label.dist=5, edge.curved=0.2)
plot.igraph(as(msx2,'igraph'),edge.arrow.size=.5, vertex.color="gold", vertex.size=15,
vertex.frame.color="gray", vertex.label.color="black",
vertex.label.cex=1, vertex.label.dist=1, edge.curved=0.2)
plot.igraph(as(msx2,'igraph'),layout=layout.kamada.kawai, vertex.color="green")
tkplot.igraph(as(msx2,'igraph'),layout=layout.kamada.kawai, vertex.color="green")
tkplot(plot.igraph(as(msx2,'igraph'),layout=layout.kamada.kawai, vertex.color="green"))
tkplot(igraph(as(msx2,'igraph'),layout=layout.kamada.kawai, vertex.color="green")))
tkplot(igraph(as(msx2,'igraph'),layout=layout.kamada.kawai, vertex.color="green"))
set.seed(1492)
l <- layout.fruchterman.reingold(ig, niter=5000, area=vcount(ig)^4*10)
set.seed(1492)
l <- layout.fruchterman.reingold(ig, niter=5000, area=vcount(ig)^4*10)
plot.igraph(as(msx2,'igraph'),edge.arrow.size=.5, vertex.color="gold", vertex.size=15,
vertex.frame.color="gray", vertex.label.color="black",
vertex.label.cex=1, vertex.label.dist=1, edge.curved=0.2,layout=layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=10000))
plot.igraph(as(msx2,'igraph'),layout=layout.kamada.kawai, vertex.color="green")
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=10000), vertex.color="green")
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=30000), vertex.color="green")
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=3000000), vertex.color="green")
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
Asteroids <- read_excel("Dataset/Asteroids_REF.xlsx")
Asteroids2 <- read_excel("Dataset/Asteroids2.xlsx")
whitelist <- read_excel("Whitelist.xlsx")
Asteroids_double<-as.data.frame(lapply(Asteroids[,2:11], as.double))
Asteroids_double["Hazardous"] <- as.factor(Asteroids_double[,10])
Asteroids2_double<-as.data.frame(lapply(Asteroids2[,2:23], as.double))
Asteroids2_double["Hazardous"] <- as.factor(Asteroids2_double[,22])
fit_mgm <- mgm(data = Asteroids2[2:23],type = c(rep("g",21),"c"),levels = c(rep(1,21),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
Asteroids2<-na.omit(Asteroids2)
fit_mgm <- mgm(data = Asteroids2[2:23],type = c(rep("g",21),"c"),levels = c(rep(1,21),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
plot.igraph(as(fit_mgm,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=3000000), vertex.color="red")
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids2[2:23] ),
color = c(rep("lightblue",21),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
msx<-cmod(~.^1.,data=Asteroids2_double[,-c(18,22)])
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids2_double[,1:15])),details=1)
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
Asteroids2_double<-na.omit(Asteroids2_double)
msx<-cmod(~.^1.,data=Asteroids2_double[,-c(18,22)])
sx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids2_double[,1:15])),details=1)
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids2_double[,1:15])),details=1)
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
Asteroids <- read_excel("Dataset/Asteroids_REF.xlsx")
Asteroids2 <- read_excel("Dataset/Asteroids2.xlsx")
Asteroids_double<-as.data.frame(lapply(Asteroids[,2:11], as.double))
Asteroids_double["Hazardous"] <- as.factor(Asteroids_double[,10])
Asteroids2_double<-as.data.frame(lapply(Asteroids2[,2:23], as.double))
Asteroids2_double["Hazardous"] <- as.factor(Asteroids2_double[,22])
Asteroids2<-na.omit(Asteroids2)
fit_mgm <- mgm(data = Asteroids2[2:23],type = c(rep("g",21),"c"),levels = c(rep(1,21),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
library(mgm)
install.packages("glmnet")
Asteroids2<-na.omit(Asteroids2)
fit_mgm <- mgm(data = Asteroids2[2:23],type = c(rep("g",21),"c"),levels = c(rep(1,21),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
install.packages("mgm")
install.packages("glmnet", dependencies=TRUE)
install.packages("glmnet", dependencies=TRUE)yes
install.packages("glmnet", dependencies=TRUE)yes
install.packages("glmnet", dependencies=TRUE)
install.packages("glmnet", repos = "http://cran.us.r-project.org")
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
install.packages("mgm")
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
Asteroids <- read_excel("Dataset/Asteroids_REF.xlsx")
Asteroids2 <- read_excel("Dataset/Asteroids2.xlsx")
Asteroids_double<-as.data.frame(lapply(Asteroids[,2:11], as.double))
Asteroids_double["Hazardous"] <- as.factor(Asteroids_double[,10])
Asteroids2_double<-as.data.frame(lapply(Asteroids2[,2:23], as.double))
Asteroids2_double["Hazardous"] <- as.factor(Asteroids2_double[,22])
Asteroids2<-na.omit(Asteroids2)
fit_mgm <- mgm(data = Asteroids2[2:23],type = c(rep("g",21),"c"),levels = c(rep(1,21),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph(fit_mgm$pairwise$wadj,edge.color = fit_mgm $pairwise$edgecolor,layout = "spring",labels =  Asteroids$colnames)
pred_obj <- predict(fit_mgm, Asteroids[1:2267,2:11])
pred_obj[["errors"]]
pred_obj <- predict(fit_mgm, Asteroids[1:2267,2:11])
pred_obj <- predict(fit_mgm, Asteroids2[,2:23])
pred_obj[["errors"]]
View(pred_obj)
pred_obj[["predicted"]]
pred_obj[["true"]][["V22."]]
confusionMatrix(Asteroids2[,23], pred_obj[["true"]][["V22."]])
install.packages("caret")
library(caret)
pred_obj[["errors"]]
confusionMatrix(Asteroids2[,23], pred_obj[["true"]][["V22."]])
Asteroids2[,23]
pred_obj[["true"]][["V22."]]
confusionMatrix(Asteroids2[,23], as.factor(pred_obj[["true"]][["V22."]]))
confusionMatrix(as.factor(Asteroids2[,23]), as.factor(pred_obj[["true"]][["V22."]]))
conf["true"]<-as.data.frame(Asteroids2[,23])
conf["true"]<-data.frame(Asteroids2[,23])
conf<-data.frame(Asteroids2[,23])
View(conf)
conf<-data.frame(Asteroids2[,23],pred_obj[["true"]][["V22."]])
View(conf)
View(conf)
conf<-data.frame(s.factor(Asteroids2[,23]),pred_obj[["true"]][["V22."]])
View(conf)
conf<-data.frame(as.factor(Asteroids2[,23]),pred_obj[["true"]][["V22."]])
View(conf)
conf<-data.frame(as.factor(as.integer(Asteroids2[,23])),pred_obj[["true"]][["V22."]])
as.integer(Asteroids2[,23])
as.factor(Asteroids2[,23])
as.string(Asteroids2[,23])
View(conf)
conf<-data.frame(Asteroids2[,23],pred_obj[["true"]][["V22."]])
View(conf)
truth = factor(Asteroids2[,23], levels = c(FALSE,TRUE))
conf<-data.frame(factor(Asteroids2[,23], levels = c(FALSE,TRUE)),pred_obj[["true"]][["V22."]])
View(conf)
factor(Asteroids2[,23], levels = c(FALSE,TRUE))
truth = factor(Asteroids2[,23], levels = c(FALSE,TRUE))
truth
truth = as.factor(Asteroids2[,23], levels = c(FALSE,TRUE))
truth = lapply(Asteroids2[,23], as.number)
truth = lapply(Asteroids2[,23], as.factor)
View(truth)
truth[["Hazardous"]]
conf<-data.frame(lapply(Asteroids2[,23], as.factor),pred_obj[["true"]][["V22."]])
View(conf)
conf<-data.frame(lapply(Asteroids2[,23], as.factor),lapply(pred_obj[["true"]][["V22."]], as.factor))
View(conf)
Asteroids <- read_excel("Dataset/Asteroids_REF.xlsx")
Asteroids2 <- read_excel("Dataset/Asteroids2.xlsx")
Asteroids_double<-as.data.frame(lapply(Asteroids[,2:11], as.double))
Asteroids_double["Hazardous"] <- as.factor(Asteroids_double[,10])
Asteroids2_double<-as.data.frame(lapply(Asteroids2[,2:23], as.double))
Asteroids2_double["Hazardous"] <- as.factor(Asteroids2_double[,22])
Asteroids2<-na.omit(Asteroids2)
fit_mgm <- mgm(data = Asteroids2[2:23],type = c(rep("g",21),"c"),levels = c(rep(1,21),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
pred_obj <- predict(fit_mgm, Asteroids2[,2:23])
pred_obj[["errors"]]
conf<-data.frame(lapply(Asteroids2[,23], as.factor),lapply(pred_obj[["true"]][["V22."]], as.factor))
View(conf)
conf<-data.frame(lapply(Asteroids2[,23], as.factor))
View(conf)
ciccio<-lapply(pred_obj[["true"]][["V22."]], as.factor)
View(ciccio)
pred_obj[["true"]][["V22."]]
ciccio<-lapply(as.data.frame(pred_obj[["true"]][["V22."]]), as.factor)
View(ciccio)
ciccio[["pred_obj[["true"]][["V22."]]"]]
View(pred_obj)
pred_obj[["true"]][["V22."]]
ciccio<-as.data.frame(pred_obj[["true"]][["V22."]])
View(ciccio)
conf<-data.frame(lapply(Asteroids2[,23], as.factor),lapply(ciccio, as.factor))
View(conf)
confusionMatrix(conf)
peppo<-confusionMatrix(conf$Hazardous,conf$pred_obj...true......V22....)
View(peppo)
plot(peppo)
peppo
View(pred_obj)
pred_obj[["predicted"]]
pred_obj[["predicted"]][22]
pred_obj[["predicted"]][,22]
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
View(ciccio)
conf<-data.frame(lapply(Asteroids2[,23], as.factor),lapply(ciccio, as.factor))
View(conf)
peppo<-confusionMatrix(conf$Hazardous,conf$pred_obj...true......V22....)
View(conf)
levels(ciccio)
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
levels(ciccio)
ciccio<-lapply(ciccio, as.factor)
levels(ciccio)
levels(ciccio)<-c("TRUE,"FALSE")
levels(ciccio)
ciccio
levels(ciccio)<-c("FALSE","TRUE")
ciccio
conf<-data.frame(lapply(Asteroids2[,23], as.factor),ciccio)
conf
peppo<-confusionMatrix(conf$Hazardous,conf$pred_obj...true......V22....)
conf
ciccio
ciccio<-lapply(ciccio, as.factor)
revalue(ciccio,c("0"=="FALSE","1"="TRUE"))
library(plyr)
revalue(ciccio,c("0"=="FALSE","1"="TRUE"))
ciccio<-lapply(ciccio, as.factor)
revalue(ciccio,c("0"=="FALSE","1"="TRUE"))
View(ciccio)
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
ciccio<-lapply(ciccio, as.factor)
ciccio
ciccio<-as.data.frame(lapply(ciccio, as.factor))
View(ciccio)
revalue(ciccio,c("0"=="FALSE","1"="TRUE"))
View(ciccio)
ciccio
ciccio<-lapply(ciccio, as.factor)
View(ciccio)
ciccio<-as.data.frame(ciccio)
View(ciccio)
ciccio<-lapply(ciccio, as.factor)
View(ciccio)
ciccio<-as.factor(as.data.frame(ciccio))
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
View(ciccio)
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
ciccio
View(ciccio)
ciccio<-as.factor(ciccio)
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
revalue(ciccio,c("0"=="FALSE","1"="TRUE"))
ciccio<-as.factor(ciccio)
ciccio<-revalue(as.factor(ciccio),c("0"=="FALSE","1"="TRUE"))
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
ciccio<-as.factor(ciccio)
ciccio<-revalue(as.factor(ciccio),c("0"=="FALSE","1"="TRUE"))
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
View(ciccio)
ciccio<-as.data.frame(as.factor(ciccio))
View(ciccio)
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
ciccio<-as.data.frame(factor(ciccio))
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
View(ciccio)
ciccio<-as.factor(as.data.frame(pred_obj[["predicted"]][,22]))
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
View(ciccio)
ciccio<-as.factor(ciccio$`pred_obj[["predicted"]][, 22]`)
ciccio
ciccio<-as.data.frame(as.factor(ciccio$`pred_obj[["predicted"]][, 22]`))
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
ciccio<-as.data.frame(as.factor(ciccio$`pred_obj[["predicted"]][, 22]`))
View(ciccio)
ciccio<-revalue(as.factor(ciccio),c("0"=="FALSE","1"="TRUE"))
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
ciccio<-as.data.frame(as.factor(ciccio$`pred_obj[["predicted"]][, 22]`))
levels(ciccio)
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
ciccio<-as.data.frame(as.factor(ciccio$`pred_obj[["predicted"]][, 22]`))
level(ciccio)
levels(ciccio)
levels(ciccio) <- c('FALSE', 'TRUE')
View(ciccio)
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
ciccio<-as.data.frame(as.factor(ciccio$`pred_obj[["predicted"]][, 22]`))
levels(ciccio) <- c('FALSE', 'TRUE')
ciccio
factor(ciccio)
factor(ciccio) <- c('FALSE', 'TRUE')
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
ciccio<-as.data.frame(as.levels(ciccio$`pred_obj[["predicted"]][, 22]`))
pred_obj[["errors"]]
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
ciccio<-as.data.frame(as.factor(ciccio$`pred_obj[["predicted"]][, 22]`))
View(ciccio)
levels(ciccio$`as.factor(ciccio$`pred_obj[["predicted"]][, 22]`)`)
levels(ciccio$`as.factor(ciccio$`pred_obj[["predicted"]][, 22]`)`)
levels(ciccio$`as.factor(ciccio$`pred_obj[["predicted"]][, 22])
levels(ciccio$as.factor(ciccio$`pred_obj[["predicted"]][, 22])
co
colname(ciccio)
colnames(ciccio)
`colnames<-c("PRED")
colnames<-c("PRED")
View(ciccio)
colnames(ciccio)<-c("PRED")
View(ciccio
colnames(ciccio)<-c("PRED")
View(Asteroids2_double)
View(ciccio)
factor(ciccio$PRED) <- c('FALSE', 'TRUE')
levels(ciccio$PRED)
levels(ciccio$PRED) <- c('FALSE', 'TRUE')
View(ciccio)
conf<-data.frame(lapply(Asteroids2[,23], as.factor),ciccio)
View(conf)
View(conf)
peppo<-confusionMatrix(conf$Hazardous,conf$PRED)
peppo
fourfoldplot(peppo)
fourfoldplot(conf)
fourfoldplot(peppo$table)
View(Asteroids2)
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
library(caret)
Asteroids <- read_excel("Dataset/Asteroids_REF.xlsx")
Asteroids2 <- read_excel("Dataset/Asteroids2.xlsx")
whitelist <- read_excel("Whitelist.xlsx")
Asteroids_double<-as.data.frame(lapply(Asteroids[,2:11], as.double))
Asteroids_double["Hazardous"] <- as.factor(Asteroids_double[,10])
Asteroids2_double<-as.data.frame(lapply(Asteroids2[,2:23], as.double))
Asteroids2_double["Hazardous"] <- as.factor(Asteroids2_double[,22])
Asteroids2<-na.omit(Asteroids2)
fit_mgm <- mgm(data = Asteroids2[1:1500,2:23],type = c(rep("g",21),"c"),levels = c(rep(1,21),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
pred_obj <- predict(fit_mgm, Asteroids2[,2:23])
pred_obj[["errors"]]
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
ciccio<-as.data.frame(as.factor(ciccio$`pred_obj[["predicted"]][, 22]`))
colnames(ciccio)<-c("PRED")
levels(ciccio$PRED) <- c('FALSE', 'TRUE')
ciccio
conf<-data.frame(lapply(Asteroids2[,23], as.factor),ciccio)
peppo<-confusionMatrix(conf$Hazardous,conf$PRED)
fourfoldplot(peppo$table)
peppo
Asteroids2<-na.omit(Asteroids2)
fit_mgm <- mgm(data = Asteroids2[1:2100,2:23],type = c(rep("g",21),"c"),levels = c(rep(1,21),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
pred_obj <- predict(fit_mgm, Asteroids2[,2:23])
pred_obj[["errors"]]
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
ciccio<-as.data.frame(as.factor(ciccio$`pred_obj[["predicted"]][, 22]`))
colnames(ciccio)<-c("PRED")
levels(ciccio$PRED) <- c('FALSE', 'TRUE')
ciccio
conf<-data.frame(lapply(Asteroids2[,23], as.factor),ciccio)
peppo<-confusionMatrix(conf$Hazardous,conf$PRED)
fourfoldplot(peppo$table)
peppo
fourfoldplot(peppo$table)
fit_mgm <- mgm(data = Asteroids2[1:3000,2:23],type = c(rep("g",21),"c"),levels = c(rep(1,21),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
pred_obj <- predict(fit_mgm, Asteroids[1:3000,2:11])
pred_obj[["errors"]]
fit_mgm <- mgm(data = Asteroids2[1:3000,2:23],type = c(rep("g",21),"c"),levels = c(rep(1,21),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
pred_obj <- predict(fit_mgm, Asteroids[1:3000,2:11])
pred_obj[["errors"]]
pred_obj <- predict(fit_mgm, Asteroids2[,2:23])
pred_obj[["errors"]]
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
ciccio<-as.data.frame(as.factor(ciccio$`pred_obj[["predicted"]][, 22]`))
colnames(ciccio)<-c("PRED")
levels(ciccio$PRED) <- c('FALSE', 'TRUE')
ciccio
conf<-data.frame(lapply(Asteroids2[,23], as.factor),ciccio)
peppo<-confusionMatrix(conf$Hazardous,conf$PRED)
fourfoldplot(peppo$table)
plot(peppo)
peppo
fit_mgm <- mgm(data = Asteroids2[1:3500,2:23],type = c(rep("g",21),"c"),levels = c(rep(1,21),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
pred_obj <- predict(fit_mgm, Asteroids[1:3500,2:11])
pred_obj[["errors"]]
pred_obj <- predict(fit_mgm, Asteroids2[,2:23])
pred_obj[["errors"]]
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
ciccio<-as.data.frame(as.factor(ciccio$`pred_obj[["predicted"]][, 22]`))
colnames(ciccio)<-c("PRED")
levels(ciccio$PRED) <- c('FALSE', 'TRUE')
ciccio
conf<-data.frame(lapply(Asteroids2[,23], as.factor),ciccio)
peppo<-confusionMatrix(conf$Hazardous,conf$PRED)
fourfoldplot(peppo$table)
peppo
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
library(caret)
Asteroids <- read_excel("Dataset/Asteroids_REF.xlsx")
Asteroids2 <- read_excel("Dataset/Asteroids2.xlsx")
whitelist <- read_excel("Whitelist.xlsx")
Asteroids_double<-as.data.frame(lapply(Asteroids[,2:11], as.double))
Asteroids_double["Hazardous"] <- as.factor(Asteroids_double[,10])
Asteroids2_double<-as.data.frame(lapply(Asteroids2[,2:23], as.double))
Asteroids2_double["Hazardous"] <- as.factor(Asteroids2_double[,22])
Asteroids2<-na.omit(Asteroids2)
fit_mgm <- mgm(data = Asteroids2[1:3500,2:23],type = c(rep("g",21),"c"),levels = c(rep(1,21),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
pred_obj <- predict(fit_mgm, Asteroids2[,2:23])
pred_obj[["errors"]]
qgraph(fit_mgm$pairwise$wadj,edge.color = fit_mgm $pairwise$edgecolor,layout = "spring",labels =  Asteroids$colnames)
pred_obj <- predict(fit_mgm, Asteroids[1:3500,2:11])
pred_obj[["errors"]]
pred_obj <- predict(fit_mgm, Asteroids2[,2:23])
pred_obj[["errors"]]
ciccio<-as.data.frame(pred_obj[["predicted"]][,22])
ciccio<-as.data.frame(as.factor(ciccio$`pred_obj[["predicted"]][, 22]`))
colnames(ciccio)<-c("PRED")
levels(ciccio$PRED) <- c('FALSE', 'TRUE')
ciccio
conf<-data.frame(lapply(Asteroids2[,23], as.factor),ciccio)
peppo<-confusionMatrix(conf$Hazardous,conf$PRED)
fourfoldplot(peppo$table)
peppo
library(pROC)
plot.roc(conf$PRED,conf$Hazardous)
pred_svm<-prediction(as.numeric(conf$PRED),as.numeric(conf$Hazardous))
library(ROCR)
install.packages("ROCR")
library(ggplot2)
pred_svm<-prediction(as.numeric(conf$PRED),as.numeric(conf$Hazardous))
library(ROCR)
pred_svm<-prediction(as.numeric(conf$PRED),as.numeric(conf$Hazardous))
roc_svm.perf <- performance(pred_svm, measure = "tpr", x.measure = "fpr")
phi_svm<-performance(pred_svm, "mi")
phi_svm@y.values
autoplot(roc_svm.perf)+theme_bw()
View(pred_svm)
plot(roc_svm.perf)
roc_svm.perf
View(roc_svm.perf)
ggplot2:autoplot(roc_svm.perf)+theme_bw()
ggplot:autoplot(roc_svm.perf)+theme_bw()
ggplot:autoplot(roc_svm.perf)+theme_bw()
plot(roc_svm.perf,colorize=TRUE)
plot(roc_svm.perf,colorize=TRUE)+theme_bw()
plot(roc_svm.perf,colorize=TRUE,box.col="gold", lwd=17, colorkey.relwidth=0.5, xaxis.cex.axis=2,
xaxis.col='blue', xaxis.col.axis="blue", yaxis.col='green', yaxis.cex.axis=2,
yaxis.at=c(0,0.5,0.8,0.85,0.9,1), yaxis.las=1, xaxis.lwd=2, yaxis.lwd=3,
yaxis.col.axis="orange", cex.lab=2, cex.main=2))
plot(roc_svm.perf,colorize=TRUE,box.col="gold", lwd=17, colorkey.relwidth=0.5, xaxis.cex.axis=2,xaxis.col='blue', xaxis.col.axis="blue", yaxis.col='green', yaxis.cex.axis=2,yaxis.at=c(0,0.5,0.8,0.85,0.9,1), yaxis.las=1, xaxis.lwd=2, yaxis.lwd=3,yaxis.col.axis="orange", cex.lab=2, cex.main=2))
plot(roc_svm.perf,colorize=TRUE,box.col="gold", lwd=17, colorkey.relwidth=0.5, xaxis.cex.axis=2,xaxis.col='blue', xaxis.col.axis="blue", yaxis.col='green', yaxis.cex.axis=2,yaxis.at=c(0,0.5,0.8,0.85,0.9,1), yaxis.las=1, xaxis.lwd=2, yaxis.lwd=3,yaxis.col.axis="orange", cex.lab=2, cex.main=2)
plot(roc_svm.perf,xaxis.lwd=2, yaxis.lwd=3)
plot(roc_svm.perf,cex.lab=2)
plot(roc_svm.perf,cex.lab=1.5)
plot(roc_svm.perf,cex.lab=1.5,box.lty=7)
plot(roc_svm.perf,cex.lab=1.5,box.lty=19)
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=2)
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=1.5,xaxis.cex.axis=1.5)
par(bg="lightblue", mai=c(1.2,1.5,1,1))
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=1.5,xaxis.cex.axis=1.5,colorize=TRUE)
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=1.5,xaxis.cex.axis=1.5,colorize=TRUE)
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=1.5,xaxis.cex.axis=1.5)
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=1.5,xaxis.cex.axis=1.5)
abline(a=0, b= 1)
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=1.5,xaxis.cex.axis=1.5)
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=1.5,xaxis.cex.axis=1.5)
abline(a=0, b= 1)
