phi_Asteroids<-performance(pred_numeric, "phi")
View(phi_Asteroids)
phi_Asteroids@y.values[[1]][3]
phi_Asteroids@y.values[[1]][2]
phi_Asteroids@y.values[[1]][2]
msx<-cmod(~.^1.,data=Asteroids_FINAL_double[,-21])
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids_FINAL_double[,-21])),details=1)
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=3000000), vertex.color="green")
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="blue")
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
Hazardous_subset<-subset(Asteroids_FINAL,Hazardous==TRUE)
Not_Hazardous_subset<-subset(Asteroids_FINAL,Hazardous==FALSE)
View(Not_Hazardous_subset)
ggdensity(Not_Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )
library(ggplot2)
ggdensity(Not_Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )
library(ggpubr)
ggdensity(Not_Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )
ggdensity(Not_Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids2[2:23] ),
color = c(rep("lightblue",21),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids_FINAL[,-1] ),
color = c(rep("lightblue",21),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids_FINAL[,-1] ),
color = c(rep("lightblue",20),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
ggdensity(Not_Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Absolute_Magnitude",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Min_Orbit_intersection",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Hazardous_subset,x="Absolute_Magnitude",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Absolute_Magnitude",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Hazardous_subset,x="Min_Orbit_intersection",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Min_Orbit_intersection",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Hazardous_subset,x="Absolute_Magnitude",rug = TRUE, color = "Absolute_Magnitude",fill = "Absolute_Magnitude" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Absolute_Magnitude",rug = TRUE, color = "Absolute_Magnitude",fill = "Absolute_Magnitude" )+theme_bw()
ggdensity(Hazardous_subset,x="Min_Orbit_intersection",rug = TRUE, color = "Min_Orbit_intersection",fill = "Min_Orbit_intersection" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Min_Orbit_intersection",rug = TRUE, color = "Min_Orbit_intersection",fill = "Min_Orbit_intersection" )+theme_bw()
Hazardous_subset<-subset(Asteroids_FINAL,Hazardous==TRUE)
Not_Hazardous_subset<-subset(Asteroids_FINAL,Hazardous==FALSE)
ggdensity(Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Hazardous_subset,x="Absolute_Magnitude",rug = TRUE, color = "Absolute_Magnitude",fill = "Absolute_Magnitude" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Absolute_Magnitude",rug = TRUE, color = "Absolute_Magnitude",fill = "Absolute_Magnitude" )+theme_bw()
ggdensity(Hazardous_subset,x="Min_Orbit_Intersection",rug = TRUE, color = "Min_Orbit_Intersection",fill = "Min_Orbit_Intersection" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Min_Orbit_Intersection",rug = TRUE, color = "Min_Orbit_Intersection",fill = "Min_Orbit_Intersection" )+theme_bw()
ggdensity(Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()+geom_line(size=2)
ggdensity(Hazardous_subset,x="Eccentricity",rug = TRUE, color = "red",fill = "Eccentricity" )+theme_bw()
ggdensity(Hazardous_subset,x="Eccentricity",rug = TRUE, color = "red",fill = "Eccentricity",size=2)+theme_bw()
ggdensity(Hazardous_subset,x="Eccentricity",rug = TRUE, color = "red",fill = "red",size=2)+theme_bw()
ggdensity(Hazardous_subset,x="Eccentricity",rug = TRUE, color = "red",fill = "red",size=2)+ggdensity(Not_Hazardous_subset,x="Eccentricity",rug = TRUE, color = "blue",fill = "blue",size=2)+theme_bw()
ggdensity(Asteroids_FINAL,x="Eccentricity",rug = TRUE, color = "Hazardous",fill = "Hazardous",size=2)+theme_bw()
ggdensity(Asteroids_FINAL,x="Eccentricity",rug = TRUE, color = "Hazardous",fill = "Hazardous",size=2)+theme_bw()
ggdensity(Asteroids_FINAL,x="Absolute_Magnitude",rug = TRUE, color = "Hazardous",fill = "Hazardous",size=2)+theme_bw()
ggdensity(Asteroids_FINAL,x="Min_Orbit_Intersection",rug = TRUE, color = "Hazardous",fill = "Hazardous",size=2)+theme_bw()
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids_FINAL[,-1] ),
color = c(rep("lightblue",20),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
View(Asteroids_FINAL)
corrplot(M_cor , p.mat = testRes$p, method = 'color', diag = FALSE, type = 'upper',
sig.level = c(0.001, 0.01, 0.05), pch.cex = 0.9,
insig = 'label_sig', pch.col = 'grey20', order = 'AOE')
M_cov <- cov(Asteroids_FINAL_double[,-21])
M_cor <- cor(Asteroids_FINAL_double[,-21])
chart.Correlation(Asteroids_FINAL_double , histogram=TRUE, pch=19)
testRes = cor.mtest(M_cor, conf.level = 0.95)
corrplot(M_cor , p.mat = testRes$p, method = 'color', diag = FALSE, type = 'upper',
sig.level = c(0.001, 0.01, 0.05), pch.cex = 0.9,
insig = 'label_sig', pch.col = 'grey20', order = 'AOE')
load("Asteroids_FINAL.rda")
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
Asteroids_FINAL_double[2:21]<-scale(Asteroids_FINAL_double[2:21])
Asteroids_FINAL_double[2:21]
load("Asteroids_FINAL.rda")
Asteroids_FINAL[,2:22]<-scale(Asteroids_FINAL[,2:22])
View(Asteroids_FINAL)
load("Asteroids_FINAL.rda")
Asteroids_FINAL[,2:21]<-scale(Asteroids_FINAL[,2:21])
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
View(Asteroids_FINAL)
ggdensity(Asteroids_FINAL,x="Eccentricity",rug = TRUE, color = "Hazardous",fill = "Hazardous",size=2)+theme_bw()
ggdensity(Asteroids_FINAL,x="Absolute_Magnitude",rug = TRUE, color = "Hazardous",fill = "Hazardous",size=2)+theme_bw()
ggdensity(Asteroids_FINAL,x="Min_Orbit_Intersection",rug = TRUE, color = "Hazardous",fill = "Hazardous",size=2)+theme_bw()
msx<-cmod(~.^1.,data=Asteroids_FINAL_double[,-21])
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids_FINAL_double[,-21])),details=1)
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
fit_mgm <- mgm(data = Asteroids_FINAL[,-1],type = c(rep("g",20),"c"),levels = c(rep(1,20),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids_FINAL[,-1] ),
color = c(rep("lightblue",20),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
pred_obj <- predict(fit_mgm, Asteroids_FINAL[,-1])
Predicted_vs_real<-as.data.frame(pred_obj[["predicted"]][,21])
Predicted_vs_real<-as.data.frame(as.factor(Predicted_vs_real$`pred_obj[["predicted"]][, 21]`))
colnames(Predicted_vs_real)<-c("PRED")
levels(Predicted_vs_real$PRED) <- c('FALSE', 'TRUE')
conf<-data.frame(lapply(Asteroids_FINAL[,22], as.factor),Predicted_vs_real)
Confusion_matrix_ASTEROIDS<-confusionMatrix(conf$Hazardous,conf$PRED)
fourfoldplot(Confusion_matrix_ASTEROIDS$table)
Confusion_matrix_ASTEROIDS
pred_numeric<-prediction(as.numeric(conf$PRED),as.numeric(conf$Hazardous))
roc_svm.perf <- performance(pred_numeric, measure = "tpr", x.measure = "fpr")
phi_Asteroids<-performance(pred_numeric, "phi")
phi_Asteroids@y.values[[1]][2]
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=1.5,xaxis.cex.axis=1.5)
abline(a=0, b= 1)
fourfoldplot(Confusion_matrix_ASTEROIDS$table,color = c("red","darkgreen"), main = "Mixed Interaction")
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(gRim)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
library(caret)
library(pROC)
library(ROCR)
library(ggplot2)
library(FactoMineR)
library(factoextra)
library(ggplot2)
library(ggpubr)
library(gRapHD)
load("Asteroids_FINAL.rda")
Asteroids_FINAL[,2:21]<-scale(Asteroids_FINAL[,2:21])
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
bf<-minForest(Asteroids_FINAL_double)
plot(bf)
plot(bf,numIter=1000)
plot(bf,numIter=100000)
mbG<-stepw(model=bf,data=Asteroids_FINAL_double)
plot(mbG)
View(mbG)
plot.igraph(as(mbG,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
autoplot(plot(mbG))
c<-plot(mbG)
View(c)
View(c)
plot(c)
plot(mbG)
bf<-minForest(Asteroids_FINAL_double,homog=TRUE,forbEdges=NULL,stat="LR")
bf
bf<-minForest(Asteroids_FINAL_double,homog=TRUE,forbEdges=NULL,stat="LR")
plot(bf)
plot(bf)
mbG<-stepw(model=bf,data=Asteroids_FINAL_double)
plot(mbG)
plot(mbG,cex.vert.label=2)
plot(mbG,cex.vert.label=1.2)
plot(mbG,cex.vert.label=1.1,numIter=6000)
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("blue","red"))
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("blue","red"))
bf<-minForest(Asteroids_FINA,homog=TRUE,forbEdges=NULL,stat="LR")
plot(bf)
mbG<-stepw(model=bf,data=Asteroids_FINAL)
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("blue","red"))
bf<-minForest(Asteroids_FINAL,homog=TRUE,forbEdges=NULL,stat="LR")
plot(bf)
mbG<-stepw(model=bf,data=Asteroids_FINAL)
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("blue","red"))
bf<-minForest(Asteroids_FINAL,homog=TRUE,forbEdges=NULL,stat="LR")
plot(bf)
bf<-minForest(Asteroids_FINAL[-1,],homog=TRUE,forbEdges=NULL,stat="LR")
plot(bf)
Asteroids_FINAL[-1,]
Asteroids_FINAL[-0,]
Asteroids_FINAL[2:22,]
Asteroids_FINAL[3:22,]
Asteroids_FINAL[3:22,1]
bf<-minForest(Asteroids_FINAL[,-1],homog=TRUE,forbEdges=NULL,stat="LR")
plot(bf)
Asteroids_FINAL[,-1]
bf<-minForest(Asteroids_FINAL[,-1],homog=TRUE,forbEdges=NULL,stat="LR")
bf<-minForest(Asteroids_FINAL[,2:22],homog=TRUE,forbEdges=NULL,stat="LR")
Asteroids_FINAL[,2:22]
load("Asteroids_FINAL.rda")
Asteroids_FINAL[,2:21]<-scale(Asteroids_FINAL[,2:21])
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
bf<-minForest(Asteroids_FINAL[,2:22],homog=TRUE,forbEdges=NULL,stat="LR")
View(Asteroids_FINAL_double)
View(Asteroids_FINAL_double)
bf<-minForest(Asteroids_FINAL_double,homog=TRUE,forbEdges=NULL,stat="LR")
plot(bf)
mbG<-stepw(model=bf,data=Asteroids_FINAL_double)
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("blue","red"))
View(Asteroids_FINAL_double)
mbG<-stepw(model=bf,data=Asteroids_FINAL_double)
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("blue","red"))
View(mbG)
mbG@numCat
mbG@numP
mbG@vertNames
mbG@edges
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("red"))
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("red"))
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("red"),vert.hl=c(1))
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("red"),vert.hl=c(1),col.hl=c("blue"))
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("red"),vert.hl=c(1),col.hl=c("blue"))
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("red"),vert.hl=c(21),col.hl=c("blue"))
mbG<-stepw(model=bf,data=Asteroids_FINAL_double,stat="LR")
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("red"),vert.hl=c(21),col.hl=c("blue"))
mbG<-stepw(model=bf,data=Asteroids_FINAL_double,stat="AIC")
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("red"),vert.hl=c(21),col.hl=c("blue"))
mbG<-stepw(model=bf,data=Asteroids_FINAL_double,exact=TRUE)
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("red"),vert.hl=c(21),col.hl=c("blue"))
fit_mgm <- mgm(data = Asteroids_FINAL[,-1],type = c(rep("g",20),"c"),levels = c(rep(1,20),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids_FINAL[,-1] ),
color = c(rep("lightblue",20),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
load("Asteroids_FINAL.rda")
Asteroids_FINAL[,2:21]<-scale(Asteroids_FINAL[,2:21])
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
bf<-minForest(Asteroids_FINAL_double,homog=TRUE,forbEdges=NULL,stat="LR")
plot(bf)
fit_mgm <- mgm(data = Asteroids_FINAL[,-1],type = c(rep("g",20),"c"),levels = c(rep(1,20),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids_FINAL[,-1] ),
color = c(rep("lightblue",20),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
mbG<-stepw(model=bf,data=Asteroids_FINAL_double,exact=TRUE)
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("red"),vert.hl=c(21),col.hl=c("blue"))
mbG<-stepw(model=bf,data=Asteroids_FINAL_double,exact=TRUE)
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("red"),vert.hl=c(21),col.hl=c("blue"))
mbG<-stepw(model=bf,data=Asteroids_FINAL_double,exact=TRUE)
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("red"),vert.hl=c(21),col.hl=c("blue"))
mbG<-stepw(model=bf,data=Asteroids_FINAL_double,exact=TRUE)
plot(mbG,cex.vert.label=1.1,numIter=6000,col.labels=c("red"),vert.hl=c(21),col.hl=c("blue"))
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids_FINAL[,-1] ),
color = c(rep("lightblue",20),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
msx<-cmod(~.^1.,data=Asteroids_FINAL_double[,-21])
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids_FINAL_double[,-21])),details=1)
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
fit_mgm <- mgm(data = Asteroids_FINAL[,-1],type = c(rep("g",20),"c"),levels = c(rep(1,20),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
fit_mgm
View(fit_mgm)
fit_mgm2 <- mgm(data = Asteroids_FINAL[,-1],type = c(rep("g",20),"c"),levels = c(rep(1,20),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph::qgraph(fit_mgm2$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids_FINAL[,-1] ),
color = c(rep("lightblue",20),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
fit_mgm2 <- mgm(data = Asteroids_FINAL[,-1],type = c(rep("g",20),"c"),levels = c(rep(1,20),2),k=3,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph::qgraph(fit_mgm2$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids_FINAL[,-1] ),
color = c(rep("lightblue",20),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
fit_mgm2 <- mgm(data = Asteroids_FINAL[,-1],type = c(rep("g",20),"c"),levels = c(rep(1,20),2),k=3,lambdaSel = "CV",lambdaFolds= 5,ruleReg="AND",overparameterize = T)
qgraph::qgraph(fit_mgm2$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids_FINAL[,-1] ),
color = c(rep("lightblue",20),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
fit_mgm2 <- mgm(data = Asteroids_FINAL[,-1],type = c(rep("g",20),"c"),levels = c(rep(1,20),2),k=3,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T,maxit=200000)
library(glasso)
install.packages("glasso")
C.body <- cor2cor(Asteroids_FINAL_double[,-21])
C.body <- cov2cor(Asteroids_FINAL_double[,-21])
S.body<- cov.wt(Asteroids_FINAL_double[,-21])$cov
C.body <- cov2cor(S.body)
res.lasso <- (C.body,rho=0.1)
AM <- res.lasso$wi!=0
diag(AM)<-FALSE
g.lasso <- as(AM,"graphNEL")
nodes(g.lasso)<-names(gRbodyfat)
glasso.body<- cmod(edgeList(g.lasso),data=gRbodyfat)
plot(as(glasso.body,"igraph"))
res.lasso <- (C.body,rho=0.1)
res.lasso <- (C.body , rho=0.1)
res.lasso <- (C.body,rho=0.1)
res.lasso<-(C.body,rho=0.1)
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(gRim)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
library(caret)
library(pROC)
library(ROCR)
library(ggplot2)
library(FactoMineR)
library(factoextra)
library(ggplot2)
library(ggpubr)
library(gRapHD)
library(glasso)
library(SIN)
msx<-cmod(~.^1.,data=Asteroids_FINAL_double[,-21])
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids_FINAL_double[,-21])),details=1)
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
S.carc <- cov.wt(Asteroids_FINAL_double[,-21], method="ML")$cov
K.carc <- solve(S.carc)
round(100*K.carc)
PC.carc <-cov2pcor(S.carc)
round(PC.carc*100)
round(100*PC.carc)
threeshold <-0.1
Z<-abs(PC.carc)
Z[Z<threeshold] <- 0
diag(Z) <- 0
Z[Z>0] <- 1
g.thresh <- as(Z,"graphNEL")
thresh.carc <- cmod(edgeList(g.thresh ), data=Asteroids_FINAL_double[,-21])
thresh.carc
plot(as(thresh.carc,"igraph"))
psin.carc<-sinUG(S.carc,n=nrow(Asteroids_FINAL_double[,-21]))
plotUGpvalues(psin.carc)
Zp<-psin.carc
Zp[]<-0
Zp[psin.carc<0.05]<- 1
g.p05<-as(Zp,"graphNEL")
pval105.carc <-cmod(edgeList(g.p05),data=Asteroids_FINAL_double[,-21])
plot(as(pval105.carc,"igraph"))
gsin.carc <-as(getgraph(psin.carc,0.1),"graphNEL")
plot(as(gsin.carc,"igraph"))
S.body<- cov.wt(Asteroids_FINAL_double[,-21])$cov
C.body <- cov2cor(S.body)
res.lasso <- glasso(C.body, rho=0.5)
AM <- res.lasso$wi!=0
diag(AM)<-FALSE
g.lasso <- as(AM,"graphNEL")
nodes(g.lasso)<-names(Asteroids_FINAL_double[,-21])
glasso.body<- cmod(edgeList(g.lasso),data=Asteroids_FINAL_double[,-21])
plot(as(glasso.body,"igraph"))
load("Asteroids_FINAL.rda")
Asteroids_FINAL[,2:21]<-scale(Asteroids_FINAL[,2:21])
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
msx<-cmod(~.^1.,data=Asteroids_FINAL_double[,-21])
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids_FINAL_double[,-21])),details=1)
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
S.carc <- cov.wt(Asteroids_FINAL_double[,-21], method="ML")$cov
K.carc <- solve(S.carc)
round(100*K.carc)
PC.carc <-cov2pcor(S.carc)
round(PC.carc*100)
round(100*PC.carc)
threeshold <-0.1
Z<-abs(PC.carc)
Z[Z<threeshold] <- 0
diag(Z) <- 0
Z[Z>0] <- 1
g.thresh <- as(Z,"graphNEL")
thresh.carc <- cmod(edgeList(g.thresh ), data=Asteroids_FINAL_double[,-21])
thresh.carc
plot(as(thresh.carc,"igraph"))
psin.carc<-sinUG(S.carc,n=nrow(Asteroids_FINAL_double[,-21]))
plotUGpvalues(psin.carc)
Zp<-psin.carc
Zp[]<-0
Zp[psin.carc<0.05]<- 1
g.p05<-as(Zp,"graphNEL")
pval105.carc <-cmod(edgeList(g.p05),data=Asteroids_FINAL_double[,-21])
plot(as(pval105.carc,"igraph"))
gsin.carc <-as(getgraph(psin.carc,0.1),"graphNEL")
plot(as(gsin.carc,"igraph"))
S.body<- cov.wt(Asteroids_FINAL_double[,-21])$cov
C.body <- cov2cor(S.body)
res.lasso <- glasso(C.body, rho=0.5)
AM <- res.lasso$wi!=0
diag(AM)<-FALSE
g.lasso <- as(AM,"graphNEL")
nodes(g.lasso)<-names(Asteroids_FINAL_double[,-21])
glasso.body<- cmod(edgeList(g.lasso),data=Asteroids_FINAL_double[,-21])
plot(as(glasso.body,"igraph"))
commonedges.carc <- msx
othermodels<-list(gsin.carc,thresh.carc,msx2)
for(i in 1:length(othermodels)) {
commonedges.carc <- graph::intersection(commonedges.carc,as(bic.carc,"graphNEL"))
}
for(i in 1:length(othermodels)) {
commonedges.carc <- graph::intersection(commonedges.carc,othermodels[[i]])
}
commonedges.carc <- msx
othermodels<-list(gsin.carc,thresh.carc,msx2)
commonedges.carc <- graph:intersection(as(msx,"graphNEL"),as(msx,"graphNEL"))
othermodels<-list(gsin.carc,thresh.carc,msx2)
library(igraph)
commonedges.carc <- graph:intersection(msx,msx)
commonedges.carc <- graph:intersection(msx2,msx2)
commonedges.carc <- graph:intersection(as(msx2,"graphNEL"),as(msx2,"graphNEL"))
commonedges.carc <- graph:intersection(as(msx2,"graphNEL"),as(msx2,"graphNEL"))
as(msx2,"graphNEL")
type(as(msx2,"graphNEL"))
commonedges.carc <- graph:intersection(as(msx2,"graphNEL"),as(msx,"graphNEL"))
commonedges.carc <- graph:intersection(as(msx2,"graphNEL"),as(msx,"graphNEL"))
commonedges.carc <- msx2
for(i in 1:length(othermodels)) {
commonedges.carc <- graph::intersection(commonedges.carc,othermodels[[i]])
}
othermodels<-lapply(othermodels,as,"graphNEL")
for(i in 1:length(othermodels)) {
commonedges.carc <- graph::intersection(commonedges.carc,othermodels[[i]])
}
commonedges.carc<-lapply(commonedges.carc,as,"graphNEL")
commonedges.carc<-lapply(msx2,as,"graphNEL")
commonedges.carc<-lapply(msx2,as,"graphNEL")
ciccio<-as(msx2,"graphNEL")
ciccio<-as(msx2,"graphNEL")
commonedges.carc<-lapply(ciccio,as,"graphNEL")
commonedges.carc<-lapply(msx2,as,"graphNEL")
commonedges.carc<-as(msx2,as,"graphNEL")
commonedges.carc<-as(msx2,"graphNEL")
othermodels<-lapply(othermodels,as,"graphNEL")
for(i in 1:length(othermodels)) {
commonedges.carc <- graph::intersection(commonedges.carc,othermodels[[i]])
}
plot(commonedges.carc)
plot(as(commonedges.carc),"graphNEL")
plot(as(commonedges.carc,"graphNEL"))
plot(as(commonedges.carc,"igraph"))
plot(as(glasso.body,"igraph"))
S.body<- cov.wt(Asteroids_FINAL_double[,-21])$cov
C.body <- cov2cor(S.body)
res.lasso <- glasso(C.body, rho=0.1)
AM <- res.lasso$wi!=0
diag(AM)<-FALSE
g.lasso <- as(AM,"graphNEL")
nodes(g.lasso)<-names(Asteroids_FINAL_double[,-21])
glasso.body<- cmod(edgeList(g.lasso),data=Asteroids_FINAL_double[,-21])
plot(as(glasso.body,"igraph"))
S.body<- cov.wt(Asteroids_FINAL_double[,-21])$cov
C.body <- cov2cor(S.body)
res.lasso <- glasso(C.body, rho=0.2)
AM <- res.lasso$wi!=0
diag(AM)<-FALSE
g.lasso <- as(AM,"graphNEL")
nodes(g.lasso)<-names(Asteroids_FINAL_double[,-21])
glasso.body<- cmod(edgeList(g.lasso),data=Asteroids_FINAL_double[,-21])
plot(as(glasso.body,"igraph"))
plot(as(commonedges.carc,"igraph"))
plot(as(glasso.body,"igraph"))
S.body<- cov.wt(Asteroids_FINAL_double[,-21])$cov
C.body <- cov2cor(S.body)
res.lasso <- glasso(C.body, rho=0.3)
AM <- res.lasso$wi!=0
diag(AM)<-FALSE
g.lasso <- as(AM,"graphNEL")
nodes(g.lasso)<-names(Asteroids_FINAL_double[,-21])
glasso.body<- cmod(edgeList(g.lasso),data=Asteroids_FINAL_double[,-21])
plot(as(glasso.body,"igraph"))
fit_mgm2 <- mgm(data = Asteroids_FINAL[,-1],type = c(rep("g",20),"c"),levels = c(rep(1,20),2),k=3,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph::qgraph(fit_mgm2$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids_FINAL[,-1] ),
color = c(rep("lightblue",20),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
fit_mgm2
