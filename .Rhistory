levels(ciccio$PRED) <- c('FALSE', 'TRUE')
ciccio
conf<-data.frame(lapply(Asteroids2[,23], as.factor),ciccio)
peppo<-confusionMatrix(conf$Hazardous,conf$PRED)
fourfoldplot(peppo$table)
peppo
library(pROC)
plot.roc(conf$PRED,conf$Hazardous)
pred_svm<-prediction(as.numeric(conf$PRED),as.numeric(conf$Hazardous))
library(ROCR)
install.packages("ROCR")
library(ggplot2)
pred_svm<-prediction(as.numeric(conf$PRED),as.numeric(conf$Hazardous))
library(ROCR)
pred_svm<-prediction(as.numeric(conf$PRED),as.numeric(conf$Hazardous))
roc_svm.perf <- performance(pred_svm, measure = "tpr", x.measure = "fpr")
phi_svm<-performance(pred_svm, "mi")
phi_svm@y.values
autoplot(roc_svm.perf)+theme_bw()
View(pred_svm)
plot(roc_svm.perf)
roc_svm.perf
View(roc_svm.perf)
ggplot2:autoplot(roc_svm.perf)+theme_bw()
ggplot:autoplot(roc_svm.perf)+theme_bw()
ggplot:autoplot(roc_svm.perf)+theme_bw()
plot(roc_svm.perf,colorize=TRUE)
plot(roc_svm.perf,colorize=TRUE)+theme_bw()
plot(roc_svm.perf,colorize=TRUE,box.col="gold", lwd=17, colorkey.relwidth=0.5, xaxis.cex.axis=2,
xaxis.col='blue', xaxis.col.axis="blue", yaxis.col='green', yaxis.cex.axis=2,
yaxis.at=c(0,0.5,0.8,0.85,0.9,1), yaxis.las=1, xaxis.lwd=2, yaxis.lwd=3,
yaxis.col.axis="orange", cex.lab=2, cex.main=2))
plot(roc_svm.perf,colorize=TRUE,box.col="gold", lwd=17, colorkey.relwidth=0.5, xaxis.cex.axis=2,xaxis.col='blue', xaxis.col.axis="blue", yaxis.col='green', yaxis.cex.axis=2,yaxis.at=c(0,0.5,0.8,0.85,0.9,1), yaxis.las=1, xaxis.lwd=2, yaxis.lwd=3,yaxis.col.axis="orange", cex.lab=2, cex.main=2))
plot(roc_svm.perf,colorize=TRUE,box.col="gold", lwd=17, colorkey.relwidth=0.5, xaxis.cex.axis=2,xaxis.col='blue', xaxis.col.axis="blue", yaxis.col='green', yaxis.cex.axis=2,yaxis.at=c(0,0.5,0.8,0.85,0.9,1), yaxis.las=1, xaxis.lwd=2, yaxis.lwd=3,yaxis.col.axis="orange", cex.lab=2, cex.main=2)
plot(roc_svm.perf,xaxis.lwd=2, yaxis.lwd=3)
plot(roc_svm.perf,cex.lab=2)
plot(roc_svm.perf,cex.lab=1.5)
plot(roc_svm.perf,cex.lab=1.5,box.lty=7)
plot(roc_svm.perf,cex.lab=1.5,box.lty=19)
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=2)
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=1.5,xaxis.cex.axis=1.5)
par(bg="lightblue", mai=c(1.2,1.5,1,1))
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=1.5,xaxis.cex.axis=1.5,colorize=TRUE)
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=1.5,xaxis.cex.axis=1.5,colorize=TRUE)
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=1.5,xaxis.cex.axis=1.5)
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=1.5,xaxis.cex.axis=1.5)
abline(a=0, b= 1)
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=1.5,xaxis.cex.axis=1.5)
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=1.5,xaxis.cex.axis=1.5)
abline(a=0, b= 1)
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
library(caret)
library(pROC)
library(ROCR)
library(ggplot2)
install.packages("corrplot")
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
library(caret)
library(pROC)
library(ROCR)
library(ggplot2)
Asteroids2 <- read_excel("Dataset/Asteroids2.xlsx")
Asteroids2_double<-as.data.frame(lapply(Asteroids2[,2:23], as.double))
Asteroids2_double["Hazardous"] <- as.factor(Asteroids2_double[,22])
SS <- CGstats(Asteroids_double)
M_cov <- cov(Asteroids_double[,2:21])
M_cor <- cor(Asteroids_double[,2:21])
chart.Correlation(Asteroids[,2:21] , histogram=TRUE, pch=19)
corrplot(M_cor, method = 'shade', order = 'AOE', diag = FALSE)
M_cov <- cov(Asteroids2_double)
M_cor <- cor(Asteroids2_double)
View(Asteroids2_double)
M_cor <- cor(Asteroids2_double[,-22])
corrplot(M_cor, method = 'shade', order = 'AOE', diag = FALSE)
View(M_cor)
View(Asteroids2_double)
Asteroids2 <- read_excel("Dataset/Asteroids2.xlsx")
Asteroids2_double<-as.data.frame(lapply(Asteroids2[,2:23], as.double))
Asteroids2_double["Hazardous"] <- as.factor(Asteroids2_double[,22])
Asteroids2_double<-na.omit(Asteroids2_double)
M_cor <- cor(Asteroids2_double[,-22])
corrplot(M_cor, method = 'shade', order = 'AOE', diag = FALSE)
corrplot(M_cor , p.mat = testRes$p, method = 'color', diag = FALSE, type = 'upper',
sig.level = c(0.001, 0.01, 0.05), pch.cex = 0.9,
insig = 'label_sig', pch.col = 'grey20', order = 'AOE')
testRes = cor.mtest(M_cor, conf.level = 0.95)
corrplot(M_cor , p.mat = testRes$p, method = 'color', diag = FALSE, type = 'upper',
sig.level = c(0.001, 0.01, 0.05), pch.cex = 0.9,
insig = 'label_sig', pch.col = 'grey20', order = 'AOE')
heatmap(x=M_cor)
library(FactoMineR)
library(factoextra)
install.packages("FactoMineR")
install.packages("factoextra")
library(FactoMineR)
library(factoextra)
res.famd <- FAMD(Asteroids2_double)
fviz_famd_var(res.famd, "quanti.var", col.var = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE)
fviz_famd_var(res.famd, "quali.var", col.var = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07")
)
fviz_famd_ind(res.famd, col.ind = "cos2",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE)
fviz_mfa_ind(res.famd,
habillage = "Label", # color by groups
palette = c("#00AFBB", "#E7B800", "#FC4E07"),
addEllipses = TRUE, ellipse.type = "confidence",
repel = TRUE # Avoid text overlapping
)
msx<-cmod(~.^1.,data=Asteroids2_double[,-c(18,22)])
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
library(caret)
library(pROC)
library(ROCR)
library(ggplot2)
library(FactoMineR)
library(factoextra)
msx<-cmod(~.^1.,data=Asteroids2_double[,-c(18,22)])
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
library(caret)
library(pROC)
library(ROCR)
library(ggplot2)
library(FactoMineR)
library(factoextra)
Asteroids2 <- read_excel("Dataset/Asteroids2.xlsx")
Asteroids2_double<-as.data.frame(lapply(Asteroids2[,2:23], as.double))
Asteroids2_double["Hazardous"] <- as.factor(Asteroids2_double[,22])
Asteroids2_double<-na.omit(Asteroids2_double)
msx<-cmod(~.^1.,data=Asteroids2_double[,-c(18,22)])
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids2_double[,1:15])),details=1)
library(gRim)
msx<-cmod(~.^1.,data=Asteroids2_double[,-c(18,22)])
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids2_double[,1:15])),details=1)
msx<-cmod(~.^1.,data=Asteroids2_double[,-c(,22)])
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids2_double[,1:15])),details=1)
as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
msx<-cmod(~.^1.,data=Asteroids2_double[,-c(,22)])
msx2<-stepwise(msx,direction="forward",k=log(nrow(data=Asteroids2_double[,-c(,22)])),details=1)
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
msx<-cmod(~.^1.,data=Asteroids2_double[,-c(22)])
msx2<-stepwise(msx,direction="forward",k=log(nrow(data=Asteroids2_double[,-c(22)])),details=1)
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
msx<-cmod(~.^1.,data=Asteroids2_double[,-c(22)])
msx<-cmod(~.^1.,data=Asteroids2_double[,-22])
Asteroids2_double[,18]
View(Asteroids2_double)
msx<-cmod(~.^1.,data=Asteroids2_double[,-c(18,22)])
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids2_double[,-c(18,22)])),details=1)
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
msx<-cmod(~.^1.,data=Asteroids2_double[,-22]
msx<-cmod(~.^1.,data=Asteroids2_double[,-22])
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids2_double[,-c(18,22)])),details=1)
View(Asteroids2_double)
View(Asteroids2_double)
msx<-cmod(~.^1.,data=Asteroids2_double[1:3500,-22])
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids2_double[,-c(18,22)])),details=1)
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
fit_mgm <- mgm(data = Asteroids2[1:3500,2:23],type = c(rep("g",21),"c"),levels = c(rep(1,21),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph(fit_mgm$pairwise$wadj,edge.color = fit_mgm $pairwise$edgecolor,layout = "spring",labels =  Asteroids$colnames)
Asteroids2<-na.omit(Asteroids2)
fit_mgm <- mgm(data = Asteroids2[1:3500,2:23],type = c(rep("g",21),"c"),levels = c(rep(1,21),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph(fit_mgm$pairwise$wadj,edge.color = fit_mgm $pairwise$edgecolor,layout = "spring",labels =  Asteroids$colnames)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids2[2:23] ),
color = c(rep("lightblue",21),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
Asteroids2 <- read_excel("Dataset/Asteroids2.xlsx")
Asteroids2_double<-as.data.frame(lapply(Asteroids2[,2:22], as.double))
Asteroids2_double["Hazardous"] <- as.factor(Asteroids2_double[,21])
Asteroids2_double<-na.omit(Asteroids2_double)
Asteroids2<-na.omit(Asteroids2)
msx<-cmod(~.^1.,data=Asteroids2_double[1:3500,-21])
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids2_double[,-21])),details=1)
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
fit_mgm <- mgm(data = Asteroids2[1:3500,-1],type = c(rep("g",21),"c"),levels = c(rep(1,21),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
fit_mgm <- mgm(data = Asteroids2[1:3500,2:22],type = c(rep("g",21),"c"),levels = c(rep(1,21),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
fit_mgm <- mgm(data = Asteroids2[1:3500,-1],type = c(rep("g",20),"c"),levels = c(rep(1,20),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
pred_obj <- predict(fit_mgm, Asteroids2[,-1])
pred_obj[["errors"]]
ciccio<-as.data.frame(pred_obj[["predicted"]][,21])
ciccio<-as.data.frame(as.factor(ciccio$`pred_obj[["predicted"]][, 21]`))
colnames(ciccio)<-c("PRED")
levels(ciccio$PRED) <- c('FALSE', 'TRUE')
ciccio
conf<-data.frame(lapply(Asteroids2[,23], as.factor),ciccio)
pred_obj <- predict(fit_mgm, Asteroids2[,-1])
pred_obj[["errors"]]
ciccio<-as.data.frame(pred_obj[["predicted"]][,21])
ciccio<-as.data.frame(as.factor(ciccio$`pred_obj[["predicted"]][, 21]`))
colnames(ciccio)<-c("PRED")
levels(ciccio$PRED) <- c('FALSE', 'TRUE')
ciccio
conf<-data.frame(lapply(Asteroids2[,22], as.factor),ciccio)
peppo<-confusionMatrix(conf$Hazardous,conf$PRED)
fourfoldplot(peppo$table)
peppo
pred_svm<-prediction(as.numeric(conf$PRED),as.numeric(conf$Hazardous))
roc_svm.perf <- performance(pred_svm, measure = "tpr", x.measure = "fpr")
phi_svm<-performance(pred_svm, "mi")
phi_svm@y.values
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=1.5,xaxis.cex.axis=1.5)
abline(a=0, b= 1)
ggplot:autoplot(roc_svm.perf)+theme_bw()
View(Asteroids2)
Asteroids2_h<-subset(Asteroids2,Hazardous==TRUE)
Asteroids2_n<-subset(Asteroids2,Hazardous==FALSE)
View(Asteroids2_h)
Asteroids_NH<- sample(3878,445)
Asteroids_NH_frame<-phl_exoplanet_catalog_RENAMED[Asteroids_NH,]
Asteroids_NH_frame<-Asteroids2[Asteroids_NH,]
Asteroids_NH<- sample(3878,445)
Asteroids_NH_frame<-Asteroids2[Asteroids_NH,]
View(Asteroids_NH_frame)
Asteroids2 <- read_excel("Dataset/Asteroids2.xlsx")
Asteroids2_double<-as.data.frame(lapply(Asteroids2[,2:22], as.double))
Asteroids2_double["Hazardous"] <- as.factor(Asteroids2_double[,21])
Asteroids2_double<-na.omit(Asteroids2_double)
Asteroids2<-na.omit(Asteroids2)
Asteroids2_h<-subset(Asteroids2,Hazardous==TRUE)
Asteroids2_n<-subset(Asteroids2,Hazardous==FALSE)
Asteroids_NH<- sample(3878,2800)
Asteroids2_h_frame<-Asteroids2[Asteroids2_h,]
Asteroids2_n_frame<-Asteroids2[-Asteroids2_h,]
Asteroids2_h_frame<-Asteroids2[Asteroids2_h,]
Asteroids2_n_frame<-Asteroids2[Asteroids2_n,]
Asteroids2_h
Asteroids2 <- read_excel("Dataset/Asteroids2.xlsx")
Asteroids2_double<-as.data.frame(lapply(Asteroids2[,2:22], as.double))
Asteroids2_double["Hazardous"] <- as.factor(Asteroids2_double[,21])
Asteroids2_double<-na.omit(Asteroids2_double)
Asteroids2<-na.omit(Asteroids2)
Asteroids2_h<-subset(Asteroids2,Hazardous==TRUE)
Asteroids2_n<-subset(Asteroids2,Hazardous==FALSE)
Asteroids_NH<- sample(3878,2800)
Asteroids2_n<-Asteroids2[Asteroids_NH,]
Asteroids_FINAL<-rbind(Asteroids2_h,Asteroids2_n)
View(Asteroids_FINAL)
Asteroids2 <- read_excel("Dataset/Asteroids2.xlsx")
Asteroids2<-na.omit(Asteroids2)
Asteroids2_h<-subset(Asteroids2,Hazardous==TRUE)
Asteroids2_n<-subset(Asteroids2,Hazardous==FALSE)
Asteroids_NH<- sample(3878,2800)
Asteroids2_n<-Asteroids2[Asteroids_NH,]
Asteroids_NH_frame<-Asteroids2[Asteroids_NH,]
Asteroids_FINAL<-rbind(Asteroids2_h,Asteroids2_n)
#save(Planets_dataset,file="Planets_dataset.rda")
#load("Planets_dataset.rda")
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
View(Asteroids_FINAL)
View(Asteroids_FINAL_double)
Asteroids2 <- read_excel("Dataset/Asteroids2.xlsx")
Asteroids2<-na.omit(Asteroids2)
Asteroids2_h<-subset(Asteroids2,Hazardous==TRUE)
Asteroids2_n<-subset(Asteroids2,Hazardous==FALSE)
Asteroids_NH<- sample(3878,2800)
Asteroids2_n<-Asteroids2[Asteroids_NH,]
Asteroids_NH_frame<-Asteroids2[Asteroids_NH,]
Asteroids_FINAL<-rbind(Asteroids2_h,Asteroids2_n)
save(Asteroids_FINAL,file="Asteroids_FINAL.rda")
load("Asteroids_FINAL.rda")
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
View(Asteroids_FINAL)
msx<-cmod(~.^1.,data=Asteroids_FINAL_double[,-21])
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids2_double[,-21])),details=1)
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
igraph.from.graphNEL(msx2)
msx<-cmod(~.^1.,data=Asteroids_FINAL_double[,-21])
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids_FINAL_double[,-21])),details=1)
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
igraph.from.graphNEL(msx2)
fit_mgm <- mgm(data = Asteroids_FINAL[,-1],type = c(rep("g",20),"c"),levels = c(rep(1,20),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
pred_obj <- predict(fit_mgm, Asteroids_FINAL[,-1])
pred_obj[["errors"]]
pred_obj <- predict(fit_mgm, Asteroids_FINAL[,-1])
pred_obj[["errors"]]
ciccio<-as.data.frame(pred_obj[["predicted"]][,21])
ciccio<-as.data.frame(as.factor(ciccio$`pred_obj[["predicted"]][, 21]`))
colnames(ciccio)<-c("PRED")
levels(ciccio$PRED) <- c('FALSE', 'TRUE')
ciccio
conf<-data.frame(lapply(Asteroids2[,22], as.factor),ciccio)
peppo<-confusionMatrix(conf$Hazardous,conf$PRED)
fourfoldplot(peppo$table)
peppo
pred_svm<-prediction(as.numeric(conf$PRED),as.numeric(conf$Hazardous))
roc_svm.perf <- performance(pred_svm, measure = "tpr", x.measure = "fpr")
phi_svm<-performance(pred_svm, "mi")
phi_svm@y.values
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=1.5,xaxis.cex.axis=1.5)
conf<-data.frame(lapply(Asteroids_FINAL[,22], as.factor),ciccio)
peppo<-confusionMatrix(conf$Hazardous,conf$PRED)
fourfoldplot(peppo$table)
peppo
pred_svm<-prediction(as.numeric(conf$PRED),as.numeric(conf$Hazardous))
roc_svm.perf <- performance(pred_svm, measure = "tpr", x.measure = "fpr")
phi_svm<-performance(pred_svm, "mi")
phi_svm@y.values
load("Asteroids_FINAL.rda")
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
fit_mgm <- mgm(data = Asteroids_FINAL[,-1],type = c(rep("g",20),"c"),levels = c(rep(1,20),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
pred_obj <- predict(fit_mgm, Asteroids_FINAL[,-1])
Predicted_vs_real<-as.data.frame(pred_obj[["predicted"]][,21])
Predicted_vs_real<-as.data.frame(as.factor(Predicted_vs_real$`pred_obj[["predicted"]][, 21]`))
colnames(Predicted_vs_real)<-c("PRED")
levels(Predicted_vs_real$PRED) <- c('FALSE', 'TRUE')
conf<-data.frame(lapply(Asteroids_FINAL[,22], as.factor),Predicted_vs_real)
Confusion_matrix_ASTEROIDS<-confusionMatrix(conf$Hazardous,conf$PRED)
fourfoldplot(Confusion_matrix_ASTEROIDS$table)
Confusion_matrix_ASTEROIDS
pred_numeric<-prediction(as.numeric(conf$PRED),as.numeric(conf$Hazardous))
roc_svm.perf <- performance(pred_numeric, measure = "tpr", x.measure = "fpr")
phi_Asteroids<-performance(pred_numeric, "mi")
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=1.5,xaxis.cex.axis=1.5)
abline(a=0, b= 1)
View(phi_Asteroids)
View(phi_Asteroids)
phi_Asteroids<-performance(pred_numeric, "phi")
View(phi_Asteroids)
plot(phi_Asteroids)
phi_Asteroids<-performance(pred_numeric, "sens", "spec")
plot(phi_Asteroids)
phi_Asteroids<-performance(pred_numeric, "phi", "acc")
plot(phi_Asteroids)
phi_Asteroids<-performance(pred_numeric, "phi")
View(phi_Asteroids)
phi_Asteroids@y.values[[1]][3]
phi_Asteroids@y.values[[1]][2]
phi_Asteroids@y.values[[1]][2]
msx<-cmod(~.^1.,data=Asteroids_FINAL_double[,-21])
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids_FINAL_double[,-21])),details=1)
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=3000000), vertex.color="green")
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="blue")
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
Hazardous_subset<-subset(Asteroids_FINAL,Hazardous==TRUE)
Not_Hazardous_subset<-subset(Asteroids_FINAL,Hazardous==FALSE)
View(Not_Hazardous_subset)
ggdensity(Not_Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )
library(ggplot2)
ggdensity(Not_Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )
library(ggpubr)
ggdensity(Not_Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )
ggdensity(Not_Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids2[2:23] ),
color = c(rep("lightblue",21),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids_FINAL[,-1] ),
color = c(rep("lightblue",21),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids_FINAL[,-1] ),
color = c(rep("lightblue",20),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
ggdensity(Not_Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Absolute_Magnitude",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Min_Orbit_intersection",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Hazardous_subset,x="Absolute_Magnitude",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Absolute_Magnitude",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Hazardous_subset,x="Min_Orbit_intersection",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Min_Orbit_intersection",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Hazardous_subset,x="Absolute_Magnitude",rug = TRUE, color = "Absolute_Magnitude",fill = "Absolute_Magnitude" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Absolute_Magnitude",rug = TRUE, color = "Absolute_Magnitude",fill = "Absolute_Magnitude" )+theme_bw()
ggdensity(Hazardous_subset,x="Min_Orbit_intersection",rug = TRUE, color = "Min_Orbit_intersection",fill = "Min_Orbit_intersection" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Min_Orbit_intersection",rug = TRUE, color = "Min_Orbit_intersection",fill = "Min_Orbit_intersection" )+theme_bw()
Hazardous_subset<-subset(Asteroids_FINAL,Hazardous==TRUE)
Not_Hazardous_subset<-subset(Asteroids_FINAL,Hazardous==FALSE)
ggdensity(Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()
ggdensity(Hazardous_subset,x="Absolute_Magnitude",rug = TRUE, color = "Absolute_Magnitude",fill = "Absolute_Magnitude" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Absolute_Magnitude",rug = TRUE, color = "Absolute_Magnitude",fill = "Absolute_Magnitude" )+theme_bw()
ggdensity(Hazardous_subset,x="Min_Orbit_Intersection",rug = TRUE, color = "Min_Orbit_Intersection",fill = "Min_Orbit_Intersection" )+theme_bw()
ggdensity(Not_Hazardous_subset,x="Min_Orbit_Intersection",rug = TRUE, color = "Min_Orbit_Intersection",fill = "Min_Orbit_Intersection" )+theme_bw()
ggdensity(Hazardous_subset,x="Eccentricity",rug = TRUE, color = "Eccentricity",fill = "Eccentricity" )+theme_bw()+geom_line(size=2)
ggdensity(Hazardous_subset,x="Eccentricity",rug = TRUE, color = "red",fill = "Eccentricity" )+theme_bw()
ggdensity(Hazardous_subset,x="Eccentricity",rug = TRUE, color = "red",fill = "Eccentricity",size=2)+theme_bw()
ggdensity(Hazardous_subset,x="Eccentricity",rug = TRUE, color = "red",fill = "red",size=2)+theme_bw()
ggdensity(Hazardous_subset,x="Eccentricity",rug = TRUE, color = "red",fill = "red",size=2)+ggdensity(Not_Hazardous_subset,x="Eccentricity",rug = TRUE, color = "blue",fill = "blue",size=2)+theme_bw()
ggdensity(Asteroids_FINAL,x="Eccentricity",rug = TRUE, color = "Hazardous",fill = "Hazardous",size=2)+theme_bw()
ggdensity(Asteroids_FINAL,x="Eccentricity",rug = TRUE, color = "Hazardous",fill = "Hazardous",size=2)+theme_bw()
ggdensity(Asteroids_FINAL,x="Absolute_Magnitude",rug = TRUE, color = "Hazardous",fill = "Hazardous",size=2)+theme_bw()
ggdensity(Asteroids_FINAL,x="Min_Orbit_Intersection",rug = TRUE, color = "Hazardous",fill = "Hazardous",size=2)+theme_bw()
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids_FINAL[,-1] ),
color = c(rep("lightblue",20),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
View(Asteroids_FINAL)
corrplot(M_cor , p.mat = testRes$p, method = 'color', diag = FALSE, type = 'upper',
sig.level = c(0.001, 0.01, 0.05), pch.cex = 0.9,
insig = 'label_sig', pch.col = 'grey20', order = 'AOE')
M_cov <- cov(Asteroids_FINAL_double[,-21])
M_cor <- cor(Asteroids_FINAL_double[,-21])
chart.Correlation(Asteroids_FINAL_double , histogram=TRUE, pch=19)
testRes = cor.mtest(M_cor, conf.level = 0.95)
corrplot(M_cor , p.mat = testRes$p, method = 'color', diag = FALSE, type = 'upper',
sig.level = c(0.001, 0.01, 0.05), pch.cex = 0.9,
insig = 'label_sig', pch.col = 'grey20', order = 'AOE')
load("Asteroids_FINAL.rda")
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
Asteroids_FINAL_double[2:21]<-scale(Asteroids_FINAL_double[2:21])
Asteroids_FINAL_double[2:21]
load("Asteroids_FINAL.rda")
Asteroids_FINAL[,2:22]<-scale(Asteroids_FINAL[,2:22])
View(Asteroids_FINAL)
load("Asteroids_FINAL.rda")
Asteroids_FINAL[,2:21]<-scale(Asteroids_FINAL[,2:21])
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
View(Asteroids_FINAL)
ggdensity(Asteroids_FINAL,x="Eccentricity",rug = TRUE, color = "Hazardous",fill = "Hazardous",size=2)+theme_bw()
ggdensity(Asteroids_FINAL,x="Absolute_Magnitude",rug = TRUE, color = "Hazardous",fill = "Hazardous",size=2)+theme_bw()
ggdensity(Asteroids_FINAL,x="Min_Orbit_Intersection",rug = TRUE, color = "Hazardous",fill = "Hazardous",size=2)+theme_bw()
msx<-cmod(~.^1.,data=Asteroids_FINAL_double[,-21])
msx2<-stepwise(msx,direction="forward",k=log(nrow(Asteroids_FINAL_double[,-21])),details=1)
plot.igraph(as(msx2,'igraph'),layout=layout.fruchterman.reingold(as(msx2,'igraph'), niter=300000), vertex.color="red")
fit_mgm <- mgm(data = Asteroids_FINAL[,-1],type = c(rep("g",20),"c"),levels = c(rep(1,20),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids_FINAL[,-1] ),
color = c(rep("lightblue",20),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
pred_obj <- predict(fit_mgm, Asteroids_FINAL[,-1])
Predicted_vs_real<-as.data.frame(pred_obj[["predicted"]][,21])
Predicted_vs_real<-as.data.frame(as.factor(Predicted_vs_real$`pred_obj[["predicted"]][, 21]`))
colnames(Predicted_vs_real)<-c("PRED")
levels(Predicted_vs_real$PRED) <- c('FALSE', 'TRUE')
conf<-data.frame(lapply(Asteroids_FINAL[,22], as.factor),Predicted_vs_real)
Confusion_matrix_ASTEROIDS<-confusionMatrix(conf$Hazardous,conf$PRED)
fourfoldplot(Confusion_matrix_ASTEROIDS$table)
Confusion_matrix_ASTEROIDS
pred_numeric<-prediction(as.numeric(conf$PRED),as.numeric(conf$Hazardous))
roc_svm.perf <- performance(pred_numeric, measure = "tpr", x.measure = "fpr")
phi_Asteroids<-performance(pred_numeric, "phi")
phi_Asteroids@y.values[[1]][2]
plot(roc_svm.perf,cex.lab=1.5,yaxis.cex.axis=1.5,xaxis.cex.axis=1.5)
abline(a=0, b= 1)
fourfoldplot(Confusion_matrix_ASTEROIDS$table,color = c("red","darkgreen"), main = "Mixed Interaction")
