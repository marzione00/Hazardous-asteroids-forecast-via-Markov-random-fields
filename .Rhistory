custom.fit(graph_mu_bn)
bn.fit(graph_mu_bn)
bn.fit(graph_mu_bn,data = Asteroids_FINAL[Asteroids_FINAL_train,-1])
ff<-aracne(Asteroids_FINAL[Asteroids_FINAL_train,-1],mi = 'mi')
ff<-aracne(Asteroids_FINAL[Asteroids_FINAL_train,-1],mi = 'mi-g')
ff<-bnlearn::aracne(Asteroids_FINAL[Asteroids_FINAL_train,-1],mi = 'mi-g')
ff<-bnlearn::aracne(discretize(Asteroids_FINAL[Asteroids_FINAL_train,-1]),mi = 'mi')
ff<-bnlearn::aracne(discretize(Asteroids_FINAL_double[Asteroids_FINAL_train,]),mi = 'mi')
load("Asteroids_FINAL.rda")
Asteroids_FINAL[,2:21]<-scale(Asteroids_FINAL[,2:21])
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
ff<-bnlearn::aracne(discretize(Asteroids_FINAL_double[Asteroids_FINAL_train,]),mi = 'mi')
View(Asteroids_FINAL_double)
ff<-bnlearn::aracne(discretize(Asteroids_FINAL_double),mi = 'mi')
View(Asteroids_FINAL)
View(Asteroids_FINAL_double)
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
View(Asteroids_FINAL_double)
discretize(Asteroids_FINAL_double)
pippo<-discretize(Asteroids_FINAL_double)
ff<-bnlearn::aracne(pippo,mi = 'mi')
View(pippo)
pippo<-discretize(Asteroids_FINAL_double)
ff<-bnlearn::aracne(pippo,mi = 'mi-g')
View(pippo)
bnlearn::aracne(Asteroids_FINAL[Asteroids_FINAL_train,-c(1,22)])
bnlearn::aracne(Asteroids_FINAL[Asteroids_FINAL_train,-1])
carciofo<-as.factor(Asteroids_FINAL[,21])
Asteroids_FINAL["Hazardous"]<-as.factor(Asteroids_FINAL[,21])
bnlearn::aracne(Asteroids_FINAL[Asteroids_FINAL_train,-1])
Asteroids_FINAL["Hazardous"]<-discretize(Asteroids_FINAL[,21])
bnlearn::aracne(Asteroids_FINAL[Asteroids_FINAL_train,-1])
View(Asteroids_FINAL)
typeof(Asteroids_FINAL[,1])
typeof(Asteroids_FINAL[,21])
typeof(Asteroids_FINAL[1,21])
typeof(Asteroids_FINAL["Hazardous"])
typeof(Asteroids_FINAL[1,"Hazardous"])
str(Asteroids_FINAL)
Asteroids_FINAL["Hazardous"]<-as.numeric(Asteroids_FINAL[,21])
Asteroids_FINAL["Hazardous"]<-as.numeric(Asteroids_FINAL["Hazardous"])
Asteroids_FINAL["Hazardous"]<-lapply(Asteroids_FINAL["Hazardous"],as.numeric)
str(Asteroids_FINAL)
bnlearn::aracne(Asteroids_FINAL[Asteroids_FINAL_train,-1])
citrone<-bnlearn::aracne(Asteroids_FINAL[Asteroids_FINAL_train,-1])
plot(citrone)
citrone<-bnlearn::aracne(Asteroids_FINAL[Asteroids_FINAL_train,-1],mi='mi-g')
plot(citrone)
plot(citrone)
load("Asteroids_FINAL.rda")
Asteroids_FINAL[,2:21]<-scale(Asteroids_FINAL[,2:21])
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
pippo<-discretize(Asteroids_FINAL[,-1])
View(pippo)
pippo<-lapply(pippo,as.numeric)
citrone<-bnlearn::aracne(pippo,mi='mi')
View(pippo)
pippo<-as.data.frame(pippo)
View(pippo)
citrone<-bnlearn::aracne(pippo,mi='mi')
citrone<-bnlearn::aracne(pippo,mi='mi-g')
plot(citrone)
load("Asteroids_FINAL.rda")
Asteroids_FINAL[,2:21]<-scale(Asteroids_FINAL[,2:21])
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
Asteroids_FINAL_train<- sample(3552,2344)
Asteroids_FINAL_test<-Asteroids_FINAL[-Asteroids_FINAL_train,]
Asteroids_FINAL_d<-discretize(Asteroids_FINAL[,-1])
Asteroids_FINAL_d<-as.data.frame(Asteroids_FINAL_d)
ff<-bnlearn::aracne(Asteroids_FINAL_d[Asteroids_FINAL_train,],mi = 'mi-g')
Asteroids_FINAL_d<-discretize(Asteroids_FINAL[,-1])
Asteroids_FINAL_d<-as.data.frame(lapply(Asteroids_FINAL_d),as.numeric))
ff<-bnlearn::aracne(Asteroids_FINAL_d[Asteroids_FINAL_train,],mi = 'mi-g')
Asteroids_FINAL_d<-discretize(Asteroids_FINAL[,-1])
Asteroids_FINAL_d<-lapply(Asteroids_FINAL_d),as.numeric)
Asteroids_FINAL_d<-lapply(Asteroids_FINAL_d),as.numeric))
Asteroids_FINAL_d<-lapply(Asteroids_FINAL_d,as.numeric)
Asteroids_FINAL_d<-as.data.frame(Asteroids_FINAL_d,as.numeric)
Asteroids_FINAL_d<-as.data.frame(Asteroids_FINAL_d)
Asteroids_FINAL_d<-discretize(Asteroids_FINAL[,-1])
Asteroids_FINAL_d<-lapply(Asteroids_FINAL_d,as.numeric)
Asteroids_FINAL_d<-as.data.frame(Asteroids_FINAL_d)
ff<-bnlearn::aracne(Asteroids_FINAL_d[Asteroids_FINAL_train,],mi = 'mi-g')
plot(ff)
Asteroids_FINAL_train<- sample(3552,2344)
Asteroids_FINAL_test<-Asteroids_FINAL[-Asteroids_FINAL_train,]
Asteroids_FINAL_d<-discretize(Asteroids_FINAL[,-1])
Asteroids_FINAL_d<-lapply(Asteroids_FINAL_d,as.numeric)
Asteroids_FINAL_d<-as.data.frame(Asteroids_FINAL_d)
ff<-bnlearn::aracne(Asteroids_FINAL_d[Asteroids_FINAL_train,],mi = 'mi-g')
plot(ff)
caio <- predict(ff,Asteroids_FINAL_d[-Asteroids_FINAL_train,])
caio <- bnlearn::predict(ff,Asteroids_FINAL_d[-Asteroids_FINAL_train,])
bnlearn::predict(ff,Asteroids_FINAL_d[-Asteroids_FINAL_train,])
bnlearn:::predict(ff,Asteroids_FINAL_d[-Asteroids_FINAL_train,])
bnlearn:::predict(ff,newdata=Asteroids_FINAL_d[-Asteroids_FINAL_train,])
bnlearn::predict(ff,newdata=Asteroids_FINAL_d[-Asteroids_FINAL_train,])
bnlearn:predict(ff,newdata=Asteroids_FINAL_d[-Asteroids_FINAL_train,])
bnlearn::predict(ff,newdata=Asteroids_FINAL_d[-Asteroids_FINAL_train,])
predict(ff,newdata=Asteroids_FINAL_d[-Asteroids_FINAL_train,])
ff
library(bnlearn)
install.packages("bnlearn")
install.packages("bnlearn")
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(gRim)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
library(caret)
library(pROC)
library(ROCR)
library(ggplot2)
library(FactoMineR)
library(factoextra)
library(ggplot2)
library(ggpubr)
library(gRapHD)
library(glasso)
library(SIN)
library(gRain)
library(randomForest)
library(randomForestExplainer)
library(e1071)
library(MASS)
library(infotheo)
library(varrank)
library(minet)
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(gRim)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
#library(caret)
library(pROC)
library(ROCR)
library(ggplot2)
library(FactoMineR)
library(factoextra)
library(ggplot2)
library(ggpubr)
library(gRapHD)
library(glasso)
library(SIN)
library(gRain)
library(randomForest)
library(randomForestExplainer)
library(e1071)
library(MASS)
library(infotheo)
library(varrank)
library(minet)
library(bnlearn)
install.packages("bnlearn")
install.packages("bnlearn")
library(bnlearn)
mim <- build.mim(Asteroids_FINAL_double)
graph_mu<-aracne(mim,estimator = "spearman", disc = "none", nbins = sqrt(NROW(mim)))
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(gRim)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
library(caret)
library(pROC)
library(ROCR)
library(ggplot2)
library(FactoMineR)
library(factoextra)
library(ggplot2)
library(ggpubr)
library(gRapHD)
library(glasso)
library(SIN)
library(gRain)
library(randomForest)
library(randomForestExplainer)
library(e1071)
library(MASS)
library(infotheo)
library(varrank)
library(minet)
load("Asteroids_FINAL.rda")
Asteroids_FINAL[,2:21]<-scale(Asteroids_FINAL[,2:21])
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
mim <- build.mim(Asteroids_FINAL_double)
graph_mu<-aracne(mim,estimator = "spearman", disc = "none", nbins = sqrt(NROW(mim)))
mim <- build.mim(Asteroids_FINAL[,-1])
graph_mu<-aracne(mim,estimator = "spearman", disc = "none", nbins = sqrt(NROW(mim)))
View(mim)
graph_mu<-aracne(mim)
plot(graph_from_graphnel( as( graph_mu ,"graphNEL")),layout=layout_with_fr(as(graph_mu,'igraph')) )
View(graph_mu)
View(graph_mu)
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(gRim)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
library(caret)
library(pROC)
library(ROCR)
library(ggplot2)
library(FactoMineR)
library(factoextra)
library(ggplot2)
library(ggpubr)
library(gRapHD)
library(glasso)
library(SIN)
library(gRain)
library(randomForest)
library(randomForestExplainer)
library(e1071)
library(MASS)
library(infotheo)
library(varrank)
library(minet)
load("Asteroids_FINAL.rda")
Asteroids_FINAL[,2:21]<-scale(Asteroids_FINAL[,2:21])
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
fit_mgm <- mgm(data = Asteroids_FINAL[,-1],type = c(rep("g",20),"c"),levels = c(rep(1,20),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
qgraph::qgraph(fit_mgm$pairwise$wadj,
layout = "spring", repulsion = 1.3,
edge.color = fit_mgm$pairwise$edgecolor,
nodeNames = colnames(Asteroids_FINAL[,-1] ),
color = c(rep("lightblue",20),"purple"),
legend.mode="style2", legend.cex=.4,
vsize = 3.5, esize = 15)
Asteroids_FINAL_double_train<- sample(3552,2344)
Asteroids_FINAL_double_test<-Asteroids_FINAL_double[-Asteroids_FINAL_double_train,]
rfor.planet <-randomForest(Hazardous~.,data=Asteroids_FINAL_double,subset=Asteroids_FINAL_double_train,localImp = TRUE,importance=TRUE,proximity=TRUE,ntry=4)
rfor.predict<-data.frame(predict(rfor.planet, Asteroids_FINAL_double_test, type = "class"))
rfor.predict["Test"]<-as.factor(Asteroids_FINAL_double_test[,21])
colnames(rfor.predict)<-c("Predict","Test")
caret::confusionMatrix(table(rfor.predict))
fourfoldplot(table(rfor.predict), color = c("red","darkgreen"),conf.level = 0)
fourfoldplot(table(rfor.predict), color = c("red","darkgreen"),conf.level = 0)
pred_for<-prediction(as.numeric(rfor.predict$Predict),as.numeric(rfor.predict$Test))
roc_for.perf <- performance(pred_for, measure = "tpr", x.measure = "fpr")
autoplot(roc_for.perf)+theme_bw()
df <- data.frame (roc_for.perff@x.values,roc_for.perf@y.values)
colnames(df)<-c("FPR", "TPR")
ggplot(df,aes(FPR,TPR))+geom_point(color="red")+geom_line(color="red")+ggtitle("ROC CURVE")+theme_bw()+theme(axis.text=element_text(size=16),axis.title=element_text(size=14,face="bold"))
df <- data.frame (roc_for.perf@x.values,roc_for.perf@y.values)
colnames(df)<-c("FPR", "TPR")
ggplot(df,aes(FPR,TPR))+geom_point(color="red")+geom_line(color="red")+ggtitle("ROC CURVE")+theme_bw()+theme(axis.text=element_text(size=16),axis.title=element_text(size=14,face="bold"))
svm.full <- svm(Hazardous~., data=Asteroids_FINAL_double[Asteroids_FINAL_double_train,],type = 'C-classification', kernel="polynomial",cost=10,degree=3,)
svm.predict_full<-data.frame(predict(svm.full,Asteroids_FINAL_double[-Asteroids_FINAL_double_train,],type = "class"))
svm.predict_full["T"]<-as.factor(Asteroids_FINAL_double_test[,21])
svm_fin_full<-data.frame(svm.predict_full,stringsAsFactors = TRUE)
colnames(svm_fin_full)<-c("Predict","Test")
caret::confusionMatrix(table(svm_fin_full))
fourfoldplot(table(svm_fin_full), color = c("red","darkgreen"),conf.level = 0, margin = 1)
pred_svm_full<-prediction(as.numeric(svm_fin_full$Predict),as.numeric(svm_fin_full$Test))
roc_svm_full.perf <- performance(pred_svm_full, measure = "tpr", x.measure = "fpr")
df <- data.frame (roc_svm_full.perf@x.values,roc_svm_full.perf@y.values)
colnames(df)<-c("FPR", "TPR")
ggplot(df,aes(FPR,TPR))+geom_point(color="red")+geom_line(color="red")+ggtitle("ROC CURVE")+theme_bw()+theme(axis.text=element_text(size=16),axis.title=element_text(size=14,face="bold"))
qda.planet<- qda(Hazardous~., data=Asteroids_FINAL_double, subset=Asteroids_FINAL_double_train)
qda.prob<-data.frame(predict(qda.planet,Asteroids_FINAL_double[-Asteroids_FINAL_double_train,],type = "response"))
qda.prob<-qda.prob["class"]
qda_fin<-data.frame(qda.prob,stringsAsFactors = TRUE)
qda_fin["Test"]<-as.factor(Asteroids_FINAL_double[-Asteroids_FINAL_double_train,21])
colnames(qda_fin)<-c("Predict","Test")
caret::confusionMatrix(table(qda_fin))
fourfoldplot(table(qda_fin), color = c("red","darkgreen"),conf.level = 0, margin = 1)
df <- data.frame (roc_qda.perf@x.values,roc_qda.perf@y.values)
colnames(df)<-c("FPR", "TPR")
ggplot(df,aes(FPR,TPR))+geom_point(color="red")+geom_line(color="red")+ggtitle("ROC CURVE")+theme_bw()+theme(axis.text=element_text(size=16),axis.title=element_text(size=14,face="bold"))
roc_qda.perf <- performance(pred_qda, measure = "tpr", x.measure = "fpr")
df <- data.frame (roc_qda.perf @x.values,roc_qda.perf @y.values)
colnames(df)<-c("FPR", "TPR")
ggplot(df,aes(FPR,TPR))+geom_point(color="red")+geom_line(color="red")+ggtitle("ROC CURVE")+theme_bw()+theme(axis.text=element_text(size=16),axis.title=element_text(size=14,face="bold"))
df <- data.frame (roc_qda.perf @x.values,roc_qda.perf @y.values)
colnames(df)<-c("FPR", "TPR")
ggplot(df,aes(FPR,TPR))+geom_point(color="red")+geom_line(color="red")+ggtitle("ROC CURVE")+theme_bw()+theme(axis.text=element_text(size=16),axis.title=element_text(size=14,face="bold"))
pred_qda<-prediction(as.numeric(qda_fin$Predict),as.numeric(qda_fin$Test))
roc_qda.perf <- performance(pred_qda, measure = "tpr", x.measure = "fpr")
df <- data.frame (roc_qda.perf @x.values,roc_qda.perf @y.values)
colnames(df)<-c("FPR", "TPR")
ggplot(df,aes(FPR,TPR))+geom_point(color="red")+geom_line(color="red")+ggtitle("ROC CURVE")+theme_bw()+theme(axis.text=element_text(size=16),axis.title=element_text(size=14,face="bold"))
model <- glm(Hazardous~.,family=binomial(link='logit'),data=Asteroids_FINAL_double)
summary(model)
logistic.prob<-data.frame(predict(model ,Asteroids_FINAL_double[-Asteroids_FINAL_double_train,],type = "response"))
colnames(logistic.prob)<-c("P")
logistic.prob<- data.frame(ifelse(logistic.prob > 0.5, "1", "0"))
logistic.prob["T"]<-as.factor(Asteroids_FINAL_double[-Asteroids_FINAL_double_train,21])
colnames(logistic.prob)<-c("P","T")
fourfoldplot(table(logistic.prob), color = c("red","darkgreen"), main = "Logistic",conf.level = 0,margin = 1)
caret::confusionMatrix(table(logistic.prob))
pred_qda<-prediction(as.numeric(logistic.prob$Predict),as.numeric(logistic.prob$Test))
View(logistic.prob)
pred_qda<-prediction(as.numeric(logistic.prob$P),as.numeric(logistic.prob$T))
roc_qda.perf <- performance(pred_qda, measure = "tpr", x.measure = "fpr")
df <- data.frame (roc_qda.perf @x.values,roc_qda.perf @y.values)
colnames(df)<-c("FPR", "TPR")
ggplot(df,aes(FPR,TPR))+geom_point(color="red")+geom_line(color="red")+ggtitle("ROC CURVE")+theme_bw()+theme(axis.text=element_text(size=16),axis.title=element_text(size=14,face="bold"))
pred_log<-prediction(as.numeric(logistic.prob$P),as.numeric(logistic.prob$T))
pred_log.perf <- performance(pred_log, measure = "tpr", x.measure = "fpr")
df <- data.frame (roc_qda.perf @x.values,roc_qda.perf @y.values)
colnames(df)<-c("FPR", "TPR")
ggplot(df,aes(FPR,TPR))+geom_point(color="red")+geom_line(color="red")+ggtitle("ROC CURVE")+theme_bw()+theme(axis.text=element_text(size=16),axis.title=element_text(size=14,face="bold"))
fourfoldplot(table(logistic.prob), color = c("red","darkgreen"),conf.level = 0,margin = 1)
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(gRim)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
library(caret)
library(pROC)
library(ROCR)
library(ggplot2)
library(FactoMineR)
library(factoextra)
library(ggplot2)
library(ggpubr)
library(gRapHD)
library(glasso)
library(SIN)
library(gRain)
library(randomForest)
library(randomForestExplainer)
library(e1071)
library(MASS)
library(infotheo)
library(varrank)
library(minet)
load("Asteroids_FINAL.rda")
Asteroids_FINAL[,2:21]<-scale(Asteroids_FINAL[,2:21])
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
fit_mgm <- mgm(data = Asteroids_FINAL[,-1],type = c(rep("g",20),"c"),levels = c(rep(1,20),2),k=2,lambdaSel = "CV",lambdaFolds= 10,ruleReg="AND",overparameterize = T)
pred_obj <- predict(fit_mgm, Asteroids_FINAL[,-1])
round(pred_obj[["probabilties"]][[21]],2)
Predicted_vs_real<-as.data.frame(pred_obj[["predicted"]][,21])
Predicted_vs_real<-as.data.frame(as.factor(Predicted_vs_real$`pred_obj[["predicted"]][, 21]`))
colnames(Predicted_vs_real)<-c("PRED")
levels(Predicted_vs_real$PRED) <- c('FALSE', 'TRUE')
conf<-data.frame(lapply(Asteroids_FINAL[,22], as.factor),Predicted_vs_real)
Confusion_matrix_ASTEROIDS<-confusionMatrix(conf$Hazardous,conf$PRED)
fourfoldplot(Confusion_matrix_ASTEROIDS$table,color = c("red","darkgreen"),conf.level = 0)
Confusion_matrix_ASTEROIDS
pred_numeric<-prediction(as.numeric(conf$PRED),as.numeric(conf$Hazardous))
roc_mgm.perf <- performance(pred_numeric,measure = "tpr", x.measure = "fpr")
phi_Asteroids<-performance(pred_numeric, "phi")
phi_Asteroids@y.values[[1]][2]
rfor.planet <-randomForest(Hazardous~.,data=Asteroids_FINAL_double,subset=Asteroids_FINAL_double_train,localImp = TRUE,importance=TRUE,proximity=TRUE,ntry=4)
rfor.predict<-data.frame(predict(rfor.planet, Asteroids_FINAL_double_test, type = "class"))
var_imp_rforest<-data.frame(varImp(rfor.planet))
colnames(var_imp_rforest)<-c("Variable","Overall")
var_imp_rforest[,1]<-rownames(var_imp_rforest)
rownames(var_imp_rforest)<-seq(1:20)
Asteroids_FINAL_double_train<- sample(3552,2344)
Asteroids_FINAL_double_test<-Asteroids_FINAL_double[-Asteroids_FINAL_double_train,]
rfor.planet <-randomForest(Hazardous~.,data=Asteroids_FINAL_double,subset=Asteroids_FINAL_double_train,localImp = TRUE,importance=TRUE,proximity=TRUE,ntry=4)
rfor.predict<-data.frame(predict(rfor.planet, Asteroids_FINAL_double_test, type = "class"))
var_imp_rforest<-data.frame(varImp(rfor.planet))
colnames(var_imp_rforest)<-c("Variable","Overall")
var_imp_rforest[,1]<-rownames(var_imp_rforest)
rownames(var_imp_rforest)<-seq(1:20)
ggplot(var_imp_rforest, aes(y=reorder(Variable,Overall),x=Overall,color="red")) +
geom_point() +
geom_segment(aes(x=0,xend=Overall,yend=Variable)) +
scale_color_discrete(name="Variable Group") +
xlab("Overall importance") +
ylab("Variable Name") + guides(color = FALSE, size = FALSE) + theme_bw()
rfor.predict["Test"]<-as.factor(Asteroids_FINAL_double_test[,21])
colnames(rfor.predict)<-c("Predict","Test")
caret::confusionMatrix(table(rfor.predict))
fourfoldplot(table(rfor.predict), color = c("red","darkgreen"),conf.level = 0)
pred_for<-prediction(as.numeric(rfor.predict$Predict),as.numeric(rfor.predict$Test))
roc_for.perf <- performance(pred_for, measure = "tpr", x.measure = "fpr")
View(roc_for.perf)
phi_Asteroids<-performance(pred_for, "phi")
phi_Asteroids
View(phi_Asteroids)
phi_Asteroids@y.values[[1]]
svm.full <- svm(Hazardous~., data=Asteroids_FINAL_double[Asteroids_FINAL_double_train,],type = 'C-classification', kernel="polynomial",cost=10,degree=3,)
svm.predict_full<-data.frame(predict(svm.full,Asteroids_FINAL_double[-Asteroids_FINAL_double_train,],type = "class"))
svm.predict_full["T"]<-as.factor(Asteroids_FINAL_double_test[,21])
svm_fin_full<-data.frame(svm.predict_full,stringsAsFactors = TRUE)
colnames(svm_fin_full)<-c("Predict","Test")
caret::confusionMatrix(table(svm_fin_full))
fourfoldplot(table(svm_fin_full), color = c("red","darkgreen"),conf.level = 0, margin = 1)
pred_svm_full<-prediction(as.numeric(svm_fin_full$Predict),as.numeric(svm_fin_full$Test))
roc_svm_full.perf <- performance(pred_svm_full, measure = "tpr", x.measure = "fpr")
phi_svm_full<-performance(pred_svm_full, "mi")
phi_Asteroids<-performance(pred_svm_full, "phi")
phi_Asteroids@y.values[[1]]
qda.planet<- qda(Hazardous~., data=Asteroids_FINAL_double, subset=Asteroids_FINAL_double_train)
qda.prob<-data.frame(predict(qda.planet,Asteroids_FINAL_double[-Asteroids_FINAL_double_train,],type = "response"))
qda.prob<-qda.prob["class"]
qda_fin<-data.frame(qda.prob,stringsAsFactors = TRUE)
qda_fin["Test"]<-as.factor(Asteroids_FINAL_double[-Asteroids_FINAL_double_train,21])
colnames(qda_fin)<-c("Predict","Test")
caret::confusionMatrix(table(qda_fin))
fourfoldplot(table(qda_fin), color = c("red","darkgreen"),conf.level = 0, margin = 1)
pred_qda<-prediction(as.numeric(qda_fin$Predict),as.numeric(qda_fin$Test))
roc_qda.perf <- performance(pred_qda, measure = "tpr", x.measure = "fpr")
phi_qda<-performance(pred_qda, "phi")
phi_qda
View(phi_qda)
phi_qda@y.values[[1]]
model <- glm(Hazardous~.,family=binomial(link='logit'),data=Asteroids_FINAL_double)
summary(model)
logistic.prob<-data.frame(predict(model ,Asteroids_FINAL_double[-Asteroids_FINAL_double_train,],type = "response"))
colnames(logistic.prob)<-c("P")
logistic.prob<- data.frame(ifelse(logistic.prob > 0.5, "1", "0"))
logistic.prob["T"]<-as.factor(Asteroids_FINAL_double[-Asteroids_FINAL_double_train,21])
colnames(logistic.prob)<-c("P","T")
fourfoldplot(table(logistic.prob), color = c("red","darkgreen"),conf.level = 0,margin = 1)
caret::confusionMatrix(table(logistic.prob))
pred_log<-prediction(as.numeric(logistic.prob$P),as.numeric(logistic.prob$T))
pred_log.perf <- performance(pred_log, measure = "tpr", x.measure = "fpr")
phi_qda<-performance(ppred_log, "phi")
phi_qda
View(pred_qda)
phi_log<-performance(pred_log, "phi")
phi_log
View(pred_log)
phi_log<-performance(pred_log, "phi")
phi_log
View(phi_log)
phi_log@y.values[[1]]
library(readxl)
library(PerformanceAnalytics)
library(corrplot)
library(ggcorrplot)
library(mgm)
library(gRim)
library(bnlearn)
library(gRapHD)
library(qgraph)
library(Rgraphviz)
library(igraph)
library(gRbase)
library(RBGL)
library(caret)
library(pROC)
library(ROCR)
library(ggplot2)
library(FactoMineR)
library(factoextra)
library(ggplot2)
library(ggpubr)
library(gRapHD)
library(glasso)
library(SIN)
library(gRain)
library(randomForest)
library(randomForestExplainer)
library(e1071)
library(MASS)
library(infotheo)
library(varrank)
library(minet)
load("Asteroids_FINAL.rda")
Asteroids_FINAL[,2:21]<-scale(Asteroids_FINAL[,2:21])
Asteroids_FINAL_double<-as.data.frame(lapply(Asteroids_FINAL[,2:22], as.double))
Asteroids_FINAL_double["Hazardous"] <- as.factor(Asteroids_FINAL_double[,21])
MI_var<- varrank(data= Asteroids_FINAL_double, variable.important = "Hazardous", discretization.method = "sturges")
plot(MI_var,margins = c(8, 8, 4, 0.1),notecex=0.5,digitcell=2,labelscex=0.6,textlines = 0.,maincex =0.5)
summary(MI_var)
mim <- build.mim(Asteroids_FINAL[,-1])
graph_mu<-aracne(mim)
plot(graph_from_graphnel( as( graph_mu ,"graphNEL")),layout=layout_with_fr(as(graph_mu,'igraph')) )
